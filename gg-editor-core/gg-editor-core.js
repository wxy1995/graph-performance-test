!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("g6v2")):"function"==typeof define&&define.amd?define(["g6v2"],t):"object"==typeof exports?exports.GGEditorCore=t(require("g6v2")):e.GGEditorCore=t(e.G6)}(window,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){var r=n(16),i=n(6),o=n(12),a=n(58),c=n(59),s=n(60),u=n(61),d=n(62),l=[a,u,n(63),n(64),s,n(66),c,d],h=function(e){var t,n;function r(t){var n,r={defaultData:null,shortcut:{redo:!0,undo:!0,delete:!0,resetZoom:!0,autoZoom:!0,zoomIn:!0,zoomOut:!0},_controllers:{},_signals:{}};return i.each(l,function(e){i.mix(r,e.CFG)}),i.deepMix(r,t),(n=e.call(this,r)||this).isPage=!0,n.type="page",n._init(),n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.getDelegation=function(e,t){var n;if(t||(t=this.getGraph().getRootGroup()),1!==e.length||e[0].isNode||e[0].isGroup){var r=i.getTotalBBox(e.map(function(e){return e.getBBox()}));(n=i.getRectByBox(r,t,o.nodeDelegationStyle)).set("capture",!1)}else e[0].isEdge?n=t.addShape("path",{attrs:Object.assign({path:"M0 0L 1 1"},o.edgeDelegationStyle),capture:!1}):(n=i.getRectByBox(e[0],t,o.nodeDelegationStyle)).set("capture",!1);return n},a.focusGraphWrapper=function(e){this.getGraph().getKeyboardEventWrapper().focus()},a.saveImage=function(e){var t,n,r=this,i=this.getGraph(),o=i.getBBox(),a=i.getFitViewPadding();return i.saveImage(Object.assign({width:o.width+a[1]+a[3],height:o.height+a[0]+a[2],beforeTransform:function(){t=r.getSelected().map(function(e){return e.id}),n=r.getSelected().map(function(e){return e.id}),r.clearSelected(),r.clearActived()},afterTransform:function(){r.setSelected(t,!0),r.setActived(n,!0)}},e))},a._init=function(){var e=this;i.each(l,function(t){t.INIT&&e[t.INIT]()}),this.bindEvent(),this._cacheBBox()},a.executeCommand=function(e,t){var n=this.editor;n?n.executeCommand(e,t):e()},a._cacheBBox=function(){var e=this.getGraph();this.set("bboxCache",e.getBBox())},a.bindEvent=function(){var e=this;this.getGraph().on("afterchange",function(){e._cacheBBox()})},a.translateLimt=function(e){var t=this.getGraph(),n=this.get("bboxCache"),r=t.getWidth(),o=t.getHeight(),a=[n.minX,n.minY,1],c=[n.maxX,n.maxY,1];return i.vec3.transformMat3(a,a,e),i.vec3.transformMat3(c,c,e),c[0]<100&&i.mat3.translate(e,e,[100-c[0],0]),c[1]<100&&i.mat3.translate(e,e,[0,100-c[1]]),a[1]>o-100&&i.mat3.translate(e,e,[0,o-100-a[1]]),a[0]>r-100&&i.mat3.translate(e,e,[r-100-a[0],0]),!0},a.setSignal=function(e,t){this.get("_signals")[e]=t},a.getSignal=function(e){return this.get("_signals")[e]},a.setController=function(e,t){this.get("_controllers")[e]=t},a.getController=function(e){return this.get("_controllers")[e]},a.destroy=function(){var e=this.get("_graph"),t=this.get("_controllers");i.each(t,function(e){e.destroy()}),e.destroy()},r}(r);i.each(l,function(e){i.mix(h.prototype,e.AUGMENT)}),e.exports=h},function(e,t,n){var r=n(3),i=n(5),o={list:[],registerCommand:function(e,t,n){if(o[e])r.mix(o[e],t);else{var a=Object.assign({enable:function(){return!0},init:function(){},execute:function(e){var t=e.getCurrentPage();this.snapShot=t.save(),this.selectedItems=t.getSelected().map(function(e){return e.id}),this.method&&(r.isString(this.method)?t[this.method]():this.method(e))},back:i,shortcutCodes:null,executeTimes:1,name:e,queue:!0},t);n&&o[n]&&(a=r.mix({},o[n],t)),o[e]=a,o.list.push(a)}},enable:function(e,t){return o[e]&&o[e].enable(t)},execute:function(e,t,n){var i=r.deepMix({},o[e],n),a=t.get("_command");return i.enable(t)&&(i.init(),i.queue&&(a.queue.splice(a.current,a.queue.length-a.current,i),a.current+=1),t.emit("beforecommandexecute",{command:i}),i.execute(t),t.emit("aftercommandexecute",{command:i}),t.setCommandDOMenable()),i}};e.exports=o},function(e,t,n){var r=n(8),i=n(23),o=n(87),a=n(88),c=n(89),s=Object.assign({},r.Util,i,o,{rectRectCrossAlgorithm:a,euclideanDistance:c});e.exports=s},function(e,t,n){var r=n(8),i=n(27),o=n(28),a={whitespace:{9:"Tab",13:"Enter",32:"Space"},fn:{112:"f1 ",113:"f2 ",114:"f3 ",115:"f4 ",116:"f5 ",117:"f6 ",118:"f7 ",119:"f8 ",120:"f9 ",121:"f10",122:"f11",123:"f12"},letter:{65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z"},number:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9"},navigation:{37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown"},symbol:{110:"decimal point",186:"semi-colon",187:"=",188:"comma",189:"-",190:"period ",191:"/",192:"grave accent",219:"open bracket ",220:"back slash ",221:"close bracket ",222:"single quote "},smallNumberKey:{96:"numpad 0 ",97:"numpad 1 ",98:"numpad 2 ",99:"numpad 3 ",100:"numpad 4 ",101:"numpad 5 ",102:"numpad 6 ",103:"numpad 7 ",104:"numpad 8 ",105:"numpad 9 "},modifierKey:{16:"Shift",17:"Ctrl ",18:"Alt",20:"caps lock"},escKey:{8:"Backspace",46:"Delete",27:"Escape"},homeKey:{91:"Windows Key / Left command",92:"right window key ",93:"Windows Menu"},computeKey:{106:"multiply ",107:"add",109:"subtract ",111:"divide "}},c=Object.assign({},r.Util,i,{getRectPath:r.G.PathUtil.rectPath,createDOM:function(e,t){var n;return(n=r.Util.isString(e)?r.Util.createDom(e):e).bbox=n.getBoundingClientRect(),n.hide=function(){return n.style.visibility="hidden",n},n.show=function(){return n.style.visibility="visible",n},n.css=function(e){return r.Util.modifyCSS(n,e),n},n.width=function(){return r.Util.getWidth(n)},n.height=function(){return r.Util.getHeight(n)},n.destroy=function(){n.parentNode&&n.parentNode.removeChild(n)},n.on=function(e,t){n.addEventListener(e,t)},n.off=function(e,t){n.removeEventListener(e,t)},n.css(t),n},getNodeSize:function(e){return e?r.Util.isNumber(e)?[e,e]:r.Util.isString(e)?-1===e.indexOf("*")?[e=Number(e),e]:e.split("*"):e:[96,48]},getTypeAndChar:function(e){for(var t in e=""+e,a)for(var n in a[t])if(n===e)return{type:t,character:a[t][n]};return{}},getKeyboradKey:function(e){return e.key||c.getTypeAndChar(e.keyCode).character},getIndex:function(e){return e.getParent().get("children").indexOf(e)},setId:function(e){e.id||(e.id=r.Util.guid())},pointLineDistance:function(e,t,n,i,o,a){var c=[n-e,i-t];if(r.Util.vec2.exactEquals(c,[0,0]))return NaN;var s=[-c[1],c[0]];r.Util.vec2.normalize(s,s);var u=[o-e,a-t];return Math.abs(r.Util.vec2.dot(u,s))},getRectByBox:function(e,t,n){return t.addShape("rect",{attrs:Object.assign({},n,{x:e.minX,y:e.minY,width:e.maxX-e.minX,height:e.maxY-e.minY})})},objectToValues:function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(e[t]);return n},getValue:function(e){return r.Util.isFunction(e)?e():e},getContrast:function(e,t){var n={};return r.Util.each(t,function(t,r){n[r]=e[r]}),n},arrowTo:function(e,t,n,i,o,a,c){var s=[a-i,c-o],u=r.Util.vec2.angleTo(s,[1,0],!0);return e.transform([["r",u],["t",t,n]]),e},setEndOfContenteditable:function(e){var t,n;document.createRange?((t=document.createRange()).selectNodeContents(e),t.collapse(!1),(n=window.getSelection()).removeAllRanges(),n.addRange(t)):document.selection&&((t=document.body.createTextRange()).moveToElementText(e),t.collapse(!1),t.select())},matches:function(e,t){return(Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}).call(e,t)},delegateEvent:function(e,t,n,r){return s.addEventListener(e,t,function(t){for(var i=t.target||t.srcElement;i!==e;)s.matches(i,n)&&r.call(i,Array.prototype.slice.call(arguments)),i=i.parentNode})},Palettes:o});e.exports=c},function(e,t){e.exports={orbitGap:10,nodeDefaultShape:"flow-node",edgeDefaultShape:"flow-smooth",groupDefaultShape:"flow-group",nodeActivedOutterStyle:{lineWidth:0},groupSelectedOutterStyle:{stroke:"#E0F0FF",lineWidth:2},nodeSelectedOutterStyle:{stroke:"#E0F0FF",lineWidth:2},edgeActivedStyle:{stroke:"#1890FF",strokeOpacity:.92},nodeActivedStyle:{fill:"#F3F9FF",stroke:"#1890FF"},groupActivedStyle:{stroke:"#1890FF"},edgeSelectedStyle:{lineWidth:2,strokeOpacity:.92,stroke:"#A3B1BF"},nodeSelectedStyle:{fill:"#F3F9FF",stroke:"#1890FF"},groupSelectedStyle:{stroke:"#1890FF",fillOpacity:.92},nodeStyle:{stroke:"#CED4D9",fill:"#FFFFFF",shadowOffsetX:0,shadowOffsetY:4,shadowBlur:10,shadowColor:"rgba(13, 26, 38, 0.08)",lineWidth:1,radius:4,fillOpacity:.92},edgeStyle:{stroke:"#A3B1BF",strokeOpacity:.92,lineWidth:2,lineAppendWidth:8,endArrow:!0},groupBackgroundPadding:[40,10,10,10],groupLabelOffsetX:10,groupLabelOffsetY:10,edgeLabelStyle:{fill:"#666",textAlign:"center",textBaseline:"middle"},edgeLabelRectPadding:4,edgeLabelRectStyle:{fill:"white"},nodeLabelStyle:{fill:"#666",textAlign:"center",textBaseline:"middle"},groupStyle:{stroke:"#CED4D9",radius:4},groupLabelStyle:{fill:"#666",textAlign:"left",textBaseline:"top"},multiSelectRectStyle:{fill:"#1890FF",fillOpacity:.08,stroke:"#1890FF",opacity:.1},dragNodeHoverToGroupStyle:{stroke:"#1890FF",lineWidth:2},dragNodeLeaveFromGroupStyle:{stroke:"#BAE7FF",lineWidth:2},anchorPointStyle:{radius:3.5,fill:"#fff",stroke:"#1890FF",lineAppendWidth:12},anchorHotsoptStyle:{radius:12,fill:"#1890FF",fillOpacity:.25},anchorHotsoptActivedStyle:{radius:14},anchorPointHoverStyle:{radius:4,fill:"#1890FF",fillOpacity:1,stroke:"#1890FF"},nodeControlPointStyle:{radius:4,fill:"#fff",shadowBlur:4,shadowColor:"#666"},edgeControlPointStyle:{radius:6,symbol:"square",lineAppendWidth:6,fillOpacity:0,strokeOpacity:0},nodeSelectedBoxStyle:{stroke:"#C2C2C2"},cursor:{panningCanvas:"-webkit-grabbing",beforePanCanvas:"-webkit-grab",hoverNode:"move",hoverEffectiveAnchor:"crosshair",hoverEdge:"default",hoverGroup:"move",hoverUnEffectiveAnchor:"default",hoverEdgeControllPoint:"crosshair",multiSelect:"crosshair"},zIndex:{anchorPoint:3,anchorHotsopt:2,selectedBox:1,controlPoint:4},polylineEdgeStyle:{offset:10,borderRadius:5},addToGroupDelayTime:400,outFromGroupDelayTime:400}},function(e,t){e.exports=function(e){var t=e.getCurrentPage();t.read(this.snapShot),t.setSelected(this.selectedItems,!0)}},function(e,t,n){var r=n(3),i=n(12),o=r.createDOM("<canvas>").getContext("2d");e.exports=Object.assign({},r,{getPanCanvasBehaviour:function(e){return function(t){var n,o,a=t.getGraph();a.behaviourOn("canvas:mouseenter",function(){t.css({cursor:i.cursor.beforePanCanvas})}),a.behaviourOn("mouseleave",function(e){e.toShape||t.css({cursor:i.cursor.beforePanCanvas})}),a.behaviourOn("mousedown",function(r){(2!==r.button&&!e||!r.shape||r.item&&!1===r.item.dragable&&"mind-root"!==r.item.shapeObj.type&&!t.getSignal("dragEdge"))&&(n={x:r.domX,y:r.domY},t.css({cursor:i.cursor.panningCanvas}),o=a.getMatrix(),t.setCapture(!1))}),a.behaviourOn("drag",function(e){if(n){var i=e.domX-n.x,c=e.domY-n.y,s=[];r.mat3.translate(s,o,[i,c]),t.translateLimt(s)&&(a.updateMatrix(s),a.draw())}}),a.behaviourOn("mouseup",function(){n&&(n=null,o=null,t.setCapture(!0),t.css({cursor:i.cursor.beforePanCanvas}))})}},getLabelTextByTextLineWidth:function(e,t,n){var r=n||320;o.font=t;var i=o.measureText(e).width;if(i>r){i=0;for(var a=1;a<e.length;a++)(i+=o.measureText(e[a]).width)>=r&&(e=e.substring(0,a)+"\n"+e.substring(a,e.length),a+=1,i=0)}return e}})},function(e,t,n){var r=n(8),i=n(15),o=n(2),a=n(90),c=n(91),s=n(93),u=n(98),d=n(99),l=[a,n(100),u,c,s,d],h=function(e){var t,n;function i(t){var n,i={shortcut:{copy:!0,paste:!0,selectAll:!0,addGroup:!0,unGroup:!0},graph:{minZoom:.2,maxZoom:2},graphConstructor:r.Graph,noEndEdge:!0},a={};return o.each(l,function(e){o.mix(a,e.CFG)}),o.deepMix(i,a,t),(n=e.call(this,i)||this).isFlow=!0,n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=i.prototype;return a._init=function(){var t=this;e.prototype._init.call(this),o.each(l,function(e){e.INIT&&t[e.INIT]()})},a.bindEvent=function(){var t=this;e.prototype.bindEvent.call(this),this.on("beforeitemactived",function(e){var n=e.item,r=t.get("_graph").getShapeObj(n).getActivedOutterStyle(n);n.isNode&&t.addOutterShape(n,r)}),this.on("beforeitemunactived",function(e){var n=e.item;(n.isNode||n.isGroup)&&t.clearOutterShape(n)}),this.on("beforeitemselected",function(e){var n=e.item,r=t.get("_graph").getShapeObj(n).getSelectedOutterStyle(n);(n.isNode||n.isGroup)&&t.addOutterShape(n,r)}),this.on("beforeitemunselected",function(e){var n=e.item;(n.isNode||n.isGroup)&&t.clearOutterShape(n)})},i}(i);o.each(l,function(e){o.mix(h.prototype,e.AUGMENT)}),i.setRegister(h,"diagram","page"),e.exports=h},function(t,n){t.exports=e},function(e,t,n){var r=n(8),i=function(){function e(e){var t=this.getDefaultCfg();r.Util.deepMix(this,t,e),this.init()}var t=e.prototype;return t.getDefaultCfg=function(){return{}},t.init=function(){},t.destroy=function(){},e}();e.exports=i},function(e,t){e.exports=function(e){var t=e.getCurrentPage();this.matrixCache=t.getMatrix().slice(0),this._zoom(e),t.updateStatus()}},function(e,t){e.exports=function(e){e.getCurrentPage().updateMatrix(this.matrixCache)}},function(e,t){e.exports={gridStyle:{stroke:"#A3B1BF",lineWidth:.5},cursor:{panningCanvas:"-webkit-grabbing",beforePanCanvas:"-webkit-grab"},wheelPanRatio:.3,alignLineStyle:{stroke:"#FA8C16",lineWidth:1},nodeDelegationStyle:{stroke:"#1890FF",fill:"#1890FF",fillOpacity:.08,lineDash:[4,4],radius:4,lineWidth:1},edgeDelegationStyle:{stroke:"#1890FF",lineDash:[4,4],lineWidth:1}}},function(e,t,n){var r=n(8),i=n(15),o=n(22),a=n(2),c=function(e){var t,n;function i(t){var n,i={graph:{modes:{default:["panBlank","hoverGroupActived","keydownCmdWheelZoom","clickEdgeSelected","clickNodeSelected","clickCanvasSelected","clickGroupSelected","hoverNodeActived","hoverEdgeActived","hoverButton","clickCollapsedButton","clickExpandedButton","wheelChangeViewport","keydownShiftMultiSelected","dragNodeAddToGroup","dragOutFromGroup","panItem","hoverEdgeControlPoint","dragEdgeControlPoint"],add:["dragPanelItemAddNode","processAddEdge"],readOnly:["panCanvas"],move:["panCanvas"],multiSelect:["dragMultiSelect"]},mode:"default",defaultIntersectBox:"circle",nodeDefaultShape:"koni-base",edgeDefaultShape:"koni-base",groupDefaultShape:"koni-base",minZoom:.5,maxZoom:2},orbit:{satellite:["forkAndLink"]},anchorLink:!1,noEndEdge:!1};return r.Util.deepMix(i,{},t),(n=e.call(this,i)||this).isKoni=!0,n}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.prototype.bindEvent=function(){e.prototype.bindEvent.call(this);var t=this.getGraph();t.on("afterchange",function(e){var n=e.item,r=e.action,i=e.originModel,c=e.updateModel;if(n&&n.isEdge)if("add"===r||"remove"===r){var s=n.getSource(),u=n.getTarget();a.getParallelEdges(s,u,!0).forEach(function(e){e.update()})}else if("update"===r){var d=t.find(i.source),l=t.find(i.target),h=[];if(a.getParallelEdges(d,l,!0).forEach(function(e){e.update()}),a.isNil(c.target)&&!a.isNil(c.source)){var g=t.find(c.source);h=a.getParallelEdges(g,l,!1)}else if(!a.isNil(c.target)&&a.isNil(c.source)){var f=t.find(c.target);h=a.getParallelEdges(d,f,!1)}else if(!a.isNil(c.target)&&!o.isNil(c.source)){var p=t.find(c.source),m=t.find(c.target);h=a.getParallelEdges(p,m,!0)}h.forEach(function(e){e.update()})}"changeData"===r&&(t.getEdges().forEach(function(e){e.update()}),t.draw())})},i}(o);i.setRegister(c,"koni","diagram"),e.exports=c},function(e,t){e.exports=function(e){return e.getCurrentPage().getSelected().length>0}},function(e,t,n){var r=n(3),i=n(0),o=n(8),a={getActivedStyle:function(){},getSelectedStyle:function(){},getStyle:function(){},getPath:function(){}};function c(e,t,n){var i=[];return r.isString(e)?i=[t,e]:r.isArray(e)?(e.unshift(t),i=e):i=[t],n&&i.unshift(n+"-base"),i}o.registerNode("page-base",Object.assign({},a)),o.registerEdge("page-base",Object.assign({},a)),o.registerGroup("page-base",Object.assign({},a)),o.registerGuide("page-base",Object.assign({},a)),i.setRegister=function(e,t,n){e.registerNode=function(e,r,i){o.registerNode(e,r,c(i,t+"-base",n))},e.registerEdge=function(e,r,i){o.registerEdge(e,r,c(i,t+"-base",n))},e.registerGroup=function(e,r,i){o.registerGroup(e,r,c(i,t+"-base",n))},e.registerGuide=function(e,r,i){o.registerGuide(e,r,c(i,t+"-base",n))},e.registerBehaviour=function(e,t,n){o.registerBehaviour(e,function(e){var n=e.get("page");n.set("_graph",e),t(n)},n)}},i.setRegister(i,"page"),n(68),e.exports=i},function(e,t,n){var r=n(3),i=function(e){var t,n;function i(t){var n,i=(n=e.call(this)||this).getDefaultCfg();return n._cfg=r.deepMix({},n._cfg,i,t),n}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=i.prototype;return o.getDefaultCfg=function(){return{}},o.get=function(e){return this._cfg[e]},o.set=function(e,t){this._cfg[e]=t},o.destroy=function(){this._cfg={},this.destroyed=!0},i}(n(31));e.exports=i},function(e,t,n){var r=n(1);n(32),n(33),n(34),n(35),n(36),n(37),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(50),n(51),n(52),n(53),n(54),n(55),n(56),n(57),e.exports=r},function(e,t){e.exports=function(e){return e.getCurrentPage().getMode()!==this.toMode}},function(e,t){e.exports=function(e){var t=e.getCurrentPage();this.fromMode=t.getMode(),t.changeMode(this.toMode)}},function(e,t){e.exports=function(e){e.getCurrentPage().changeMode(this.fromMode)}},function(e,t,n){var r=n(3);e.exports=function(e){var t={},n=[];return e.forEach(function(e){var i=e.model,o=r.deepMix({},Object.assign({},i,{id:r.guid()}));t[i.id]=o.id,n.push(Object.assign({},e,{model:o}))}),n.forEach(function(e){var n=e.model;if(n.parent){var r=t[n.parent];r?n.parent=r:delete n.parent}}),n.sort(function(e,t){return e.index-t.index}),n}},function(e,t,n){var r=n(7);n(101),n(109),e.exports=r},function(e,t,n){var r=n(6);e.exports=Object.assign({},r,{getParallelEdges:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.getEdges().filter(function(e){var r=e.getModel();return r.target===t.id||n&&r.source===t.id})},object2array:function(e){var t=[];return r.each(e,function(e){t.push(e)}),t}})},function(e,t,n){var r=n(9),i=n(2),o=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.getDefaultCfg=function(){return{name:"",render:function(){return"<button>satellite</button>"},bindEvent:function(){return[]}}},o._renderDOM=function(){var e=i.createDOM(this.render(this.diagram));return this.dom=e,e.isSatellite=!0,e},o.getDOM=function(){return this.dom||this._renderDOM()},o.init=function(){var e=this.getDOM(),t=this.diagram.getGraph().getGraphContainer();e&&e.css({position:"absolute",visibility:"hidden"}),t.appendChild(e),e&&this.bindEvent(e,this.diagram)},o.enable=function(){return!0},o.show=function(){this.getDOM().show()},o.hide=function(){this.getDOM().hide()},o.isVisible=function(){return"hidden"!==this.getDOM().style.visibility},o.destroy=function(){var e=this.events;e&&e.forEach(function(e){e.remove()})},r}(r);e.exports=o},function(e,t,n){var r=n(26),i=n(17),o=n(3);r.Editor=r,r.Page=n(15),r.Diagram=n(22),r.Koni=n(124),r.Toolbar=n(130),r.Contextmenu=n(131),r.Command=i,r.Util=o,r.registerBehaviour=r.Page.registerBehaviour,r.registerNode=r.Page.registerNode,r.registerEdge=r.Page.registerEdge,r.registerGroup=r.Page.registerGroup,r.registerGuide=r.Page.registerGuide,r.registerCommand=i.registerCommand,e.exports=r},function(e,t,n){var r=n(16),i=n(3),o=n(17),a=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.getDefaultCfg=function(){return{_components:[],_command:{zoomDelta:.1,queue:[],current:0,clipboard:[]}}},a._getComponentsBy=function(e){return this.get("_components").filter(e)},a._bindCommands=function(e){var t=this;i.each(e,function(e){var n=e.dataset,r=n.command;o[r]?i.addEventListener(e,"click",function(){t.executeCommand(r,n)}):console.warn("请设置有效的命令！")})},a.getCommands=function(){return this.get("_command").queue},a.getCurrentCommand=function(){var e=this.get("_command");return e.queue[e.current-1]},a.executeCommand=function(e,t){i.isString(e)?o.execute(e,this,t):o.execute("common",this,{method:e},t)},a.commandEnable=function(e){return o.enable(e,this)},a.setCommandDOMenable=function(){var e=this,t=this.getComponentsByType("toolbar"),n=this.getComponentsByType("contextmenu"),r=[];t.forEach(function(e){i.each(e.getCommandDoms(),function(e){r.push(e)})}),n.forEach(function(e){i.each(e.getCommandDoms(),function(e){r.push(e)})}),i.each(r,function(t){var n=t.dataset.command;o.enable(n,e)?t.classList.remove("disable"):t.classList.add("disable")})},a._onPageStatusChange=function(){this.setCommandDOMenable()},a._afterAddContextmenu=function(){this.getCurrentPage()&&this.setCommandDOMenable()},a._afterAddPage=function(e){var t=this;this.setCommandDOMenable(),e.on("statuschange",function(e){t._onPageStatusChange(e)}),e.on("mousedown",function(){t.getComponentsByType("contextmenu").forEach(function(e){e.hide()})}),e.on("contextmenu",function(n){var r=t.getComponentsByType("contextmenu"),o=e.getGraph().getCanvas().get("el"),a=i.getBoundingClientRect(o),c={x:n.x,y:n.y},s=n.item;s&&!s.isSelected&&(e.clearSelected(),e.setSelected(n.item,!0)),t.set("contextmenuPoint",c),n.domEvent.preventDefault(),r.forEach(function(e){e.show(),e.contextmenuPoint=c,e.move(a.left+n.domX,a.top+n.domY)})}),e.on("statuschange",function(e){t.getComponentsByType("contextmenu").forEach(function(t){t.switch(e.status)})}),this._bindShortcut(e)},a._beforeAddToolbar=function(e){var t=e.getCommandDoms();this._bindCommands(t)},a._beforeAddContextmenu=function(e){var t=e.getCommandDoms();e.bindEvent(),this._bindCommands(t)},a.getComponentsByType=function(e){return this._getComponentsBy(function(t){return t.type===e})},a.getCurrentPage=function(){var e,t=this.getComponentsByType("page");return t.every(function(t){return!t.isActived||(e=t,!1)}),e||(e=t[0]),e},a.getComponents=function(){return this.get("_components")},a._shortcutEnable=function(e,t){for(var n=e.shortcutCodes,r=i.getKeyboradKey(t),o=!1,a=0;a<n.length;a++){var c=n[a];if(i.isArray(c)){for(var s=!0,u=c.length,d=0;d<u-1;d++)if(!t[c[d]]){s=!1;break}c[u-1]!==r&&c[u-1]!==i.lowerFirst(r)||s&&(o=!0)}else c===r&&(o=!0);if(o)break}return o},a._bindShortcut=function(e){var t=this,n=e.get("shortcut");e.getGraph().on("keydown",function(e){var r=t.getComponentsByType("contextmenu"),i=e.domEvent;r.forEach(function(e){e.hide()}),i.preventDefault();for(var a=o.list.filter(function(e){return e.shortcutCodes&&n[e.name]}),c=0;c<a.length;c++){var s=a[c];if(t._shortcutEnable(s,i))return t.executeCommand(s.name),!1}})},a.add=function(e){var t=this.get("_components"),n=i.upperFirst(e.type);e.editor=this,this["_beforeAdd"+n]&&this["_beforeAdd"+n](e),t.push(e),this["_afterAdd"+n]&&this["_afterAdd"+n](e)},a.destroy=function(){this.get("_components").forEach(function(e){e.destroy()})},r}(r);e.exports=a},function(e,t,n){var r={getRectPath:n(8).G.PathUtil.rectPath};e.exports={getGroupIconPath:function(){return"M9.75,9.60000014 L3.75,9.60000014 C3.33578644,9.60000014 3,9.2865995 3,8.90000022 C3,8.51340093 3.33578644,8.20000029 3.75,8.20000029 L9.75,8.20000029 C10.1642136,8.20000029 10.5,8.51340093 10.5,8.90000022 C10.5,9.2865995 10.1642136,9.60000014 9.75,9.60000014 M3,11.6999999 C3,11.3134006 3.33578644,11 3.75,11 L6.75,11 C7.16421356,11 7.5,11.3134006 7.5,11.6999999 C7.5,12.0865992 7.16421356,12.3999999 6.75,12.3999999 L3.75,12.3999999 C3.33578644,12.3999999 3,12.0865992 3,11.6999999 M3.75,13.7999997 L6.75,13.7999997 C7.16421356,13.7999997 7.5,14.1134004 7.5,14.4999996 C7.5,14.8865989 7.16421356,15.1999996 6.75,15.1999996 L3.75,15.1999996 C3.33578644,15.1999996 3,14.8865989 3,14.4999996 C3,14.1134004 3.33578644,13.7999997 3.75,13.7999997 M16.4985,4.00000072 L1.5015,4.00000072 C0.674533504,3.99922416 0.00289396564,4.6232696 0,5.39510058 L0,16.6048994 C0.00289396564,17.3767304 0.674533504,18.0007758 1.5015,17.9999993 L16.4985,17.9999993 C17.3254665,18.0007758 17.997106,17.3767304 18,16.6048994 L18,5.39510058 C17.997106,4.6232696 17.3254665,3.99922416 16.4985,4.00000072M19,13.9999993 L19,3 L5,3 L5,1.39510058 C5.00289397,0.623269599 5.6745335,-0.00077583787 6.5015,7.23978642e-07 L21.4985,7.23978642e-07 C22.3254665,-0.00077583787 22.997106,0.623269599 23,1.39510058 L23,12.6048994 C22.997106,13.3767304 22.3254665,14.0007758 21.4985,13.9999993 L19,13.9999993 Z"},getCollapsedButtonPath:function(){return r.getRectPath(0,0,14,14,2)+"M3,7L11,7"},getExpandedButtonPath:function(){return r.getRectPath(0,0,14,14,2)+"M3,7L11,7M7,3L7,11"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.presetPrimaryColors=t.presetPalettes=t.generate=void 0;var r,i=n(29),o=(r=i)&&r.__esModule?r:{default:r};var a={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1890FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},c={};Object.keys(a).forEach(function(e){c[e]=(0,o.default)(a[e])}),t.generate=o.default,t.presetPalettes=c,t.presetPrimaryColors=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=(0,o.default)(e),r=l;r>0;r-=1){var i=n.toHsv(),a=(0,o.default)({h:g(i,r,!0),s:f(i,r,!0),v:p(i,r,!0)}).toHexString();t.push(a)}t.push(n.toHexString());for(var c=1;c<=h;c+=1){var s=n.toHsv(),u=(0,o.default)({h:g(s,c),s:f(s,c),v:p(s,c)}).toHexString();t.push(u)}return t};var r,i=n(30),o=(r=i)&&r.__esModule?r:{default:r};var a=2,c=16,s=5,u=5,d=15,l=5,h=4;function g(e,t,n){var r=void 0;return(r=Math.round(e.h)>=60&&Math.round(e.h)<=240?n?Math.round(e.h)-a*t:Math.round(e.h)+a*t:n?Math.round(e.h)+a*t:Math.round(e.h)-a*t)<0?r+=360:r>=360&&(r-=360),r}function f(e,t,n){if(0===e.h&&0===e.s)return e.s;var r=void 0;return(r=n?Math.round(100*e.s)-c*t:t===h?Math.round(100*e.s)+c:Math.round(100*e.s)+s*t)>100&&(r=100),n&&t===l&&r>10&&(r=10),r<6&&(r=6),r}function p(e,t,n){return n?Math.round(100*e.v)+u*t:Math.round(100*e.v)-d*t}},function(e,t,n){var r;!function(i){var o=/^\s+/,a=/\s+$/,c=0,s=i.round,u=i.min,d=i.max,l=i.random;function h(e,t){if(t=t||{},(e=e||"")instanceof h)return e;if(!(this instanceof h))return new h(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,r=null,c=null,s=null,l=!1,h=!1;"string"==typeof e&&(e=function(e){e=e.replace(o,"").replace(a,"").toLowerCase();var t,n=!1;if(O[e])e=O[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=z.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=z.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=z.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=z.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=z.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=z.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=z.hex8.exec(e))return{r:L(t[1]),g:L(t[2]),b:L(t[3]),a:X(t[4]),format:n?"name":"hex8"};if(t=z.hex6.exec(e))return{r:L(t[1]),g:L(t[2]),b:L(t[3]),format:n?"name":"hex"};if(t=z.hex4.exec(e))return{r:L(t[1]+""+t[1]),g:L(t[2]+""+t[2]),b:L(t[3]+""+t[3]),a:X(t[4]+""+t[4]),format:n?"name":"hex8"};if(t=z.hex3.exec(e))return{r:L(t[1]+""+t[1]),g:L(t[2]+""+t[2]),b:L(t[3]+""+t[3]),format:n?"name":"hex"};return!1}(e));"object"==typeof e&&(H(e.r)&&H(e.g)&&H(e.b)?(g=e.r,f=e.g,p=e.b,t={r:255*B(g,255),g:255*B(f,255),b:255*B(p,255)},l=!0,h="%"===String(e.r).substr(-1)?"prgb":"rgb"):H(e.h)&&H(e.s)&&H(e.v)?(r=T(e.s),c=T(e.v),t=function(e,t,n){e=6*B(e,360),t=B(t,100),n=B(n,100);var r=i.floor(e),o=e-r,a=n*(1-t),c=n*(1-o*t),s=n*(1-(1-o)*t),u=r%6;return{r:255*[n,c,a,a,s,n][u],g:255*[s,n,n,c,a,a][u],b:255*[a,a,s,n,n,c][u]}}(e.h,r,c),l=!0,h="hsv"):H(e.h)&&H(e.s)&&H(e.l)&&(r=T(e.s),s=T(e.l),t=function(e,t,n){var r,i,o;function a(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=B(e,360),t=B(t,100),n=B(n,100),0===t)r=i=o=n;else{var c=n<.5?n*(1+t):n+t-n*t,s=2*n-c;r=a(s,c,e+1/3),i=a(s,c,e),o=a(s,c,e-1/3)}return{r:255*r,g:255*i,b:255*o}}(e.h,r,s),l=!0,h="hsl"),e.hasOwnProperty("a")&&(n=e.a));var g,f,p;return n=G(n),{ok:l,format:e.format||h,r:u(255,d(t.r,0)),g:u(255,d(t.g,0)),b:u(255,d(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=s(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=s(this._r)),this._g<1&&(this._g=s(this._g)),this._b<1&&(this._b=s(this._b)),this._ok=n.ok,this._tc_id=c++}function g(e,t,n){e=B(e,255),t=B(t,255),n=B(n,255);var r,i,o=d(e,t,n),a=u(e,t,n),c=(o+a)/2;if(o==a)r=i=0;else{var s=o-a;switch(i=c>.5?s/(2-o-a):s/(o+a),o){case e:r=(t-n)/s+(t<n?6:0);break;case t:r=(n-e)/s+2;break;case n:r=(e-t)/s+4}r/=6}return{h:r,s:i,l:c}}function f(e,t,n){e=B(e,255),t=B(t,255),n=B(n,255);var r,i,o=d(e,t,n),a=u(e,t,n),c=o,s=o-a;if(i=0===o?0:s/o,o==a)r=0;else{switch(o){case e:r=(t-n)/s+(t<n?6:0);break;case t:r=(n-e)/s+2;break;case n:r=(e-t)/s+4}r/=6}return{h:r,s:i,v:c}}function p(e,t,n,r){var i=[N(s(e).toString(16)),N(s(t).toString(16)),N(s(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function m(e,t,n,r){return[N(F(r)),N(s(e).toString(16)),N(s(t).toString(16)),N(s(n).toString(16))].join("")}function v(e,t){t=0===t?0:t||10;var n=h(e).toHsl();return n.s-=t/100,n.s=D(n.s),h(n)}function y(e,t){t=0===t?0:t||10;var n=h(e).toHsl();return n.s+=t/100,n.s=D(n.s),h(n)}function b(e){return h(e).desaturate(100)}function x(e,t){t=0===t?0:t||10;var n=h(e).toHsl();return n.l+=t/100,n.l=D(n.l),h(n)}function S(e,t){t=0===t?0:t||10;var n=h(e).toRgb();return n.r=d(0,u(255,n.r-s(-t/100*255))),n.g=d(0,u(255,n.g-s(-t/100*255))),n.b=d(0,u(255,n.b-s(-t/100*255))),h(n)}function C(e,t){t=0===t?0:t||10;var n=h(e).toHsl();return n.l-=t/100,n.l=D(n.l),h(n)}function A(e,t){var n=h(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,h(n)}function _(e){var t=h(e).toHsl();return t.h=(t.h+180)%360,h(t)}function P(e){var t=h(e).toHsl(),n=t.h;return[h(e),h({h:(n+120)%360,s:t.s,l:t.l}),h({h:(n+240)%360,s:t.s,l:t.l})]}function w(e){var t=h(e).toHsl(),n=t.h;return[h(e),h({h:(n+90)%360,s:t.s,l:t.l}),h({h:(n+180)%360,s:t.s,l:t.l}),h({h:(n+270)%360,s:t.s,l:t.l})]}function E(e){var t=h(e).toHsl(),n=t.h;return[h(e),h({h:(n+72)%360,s:t.s,l:t.l}),h({h:(n+216)%360,s:t.s,l:t.l})]}function M(e,t,n){t=t||6,n=n||30;var r=h(e).toHsl(),i=360/n,o=[h(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,o.push(h(r));return o}function I(e,t){t=t||6;for(var n=h(e).toHsv(),r=n.h,i=n.s,o=n.v,a=[],c=1/t;t--;)a.push(h({h:r,s:i,v:o})),o=(o+c)%1;return a}h.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,r=this.toRgb();return e=r.r/255,t=r.g/255,n=r.b/255,.2126*(e<=.03928?e/12.92:i.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:i.pow((t+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:i.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=G(e),this._roundA=s(100*this._a)/100,this},toHsv:function(){var e=f(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=f(this._r,this._g,this._b),t=s(360*e.h),n=s(100*e.s),r=s(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=g(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=g(this._r,this._g,this._b),t=s(360*e.h),n=s(100*e.s),r=s(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return p(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var o=[N(s(e).toString(16)),N(s(t).toString(16)),N(s(n).toString(16)),N(F(r))];if(i&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1))return o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0);return o.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:s(this._r),g:s(this._g),b:s(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+s(this._r)+", "+s(this._g)+", "+s(this._b)+")":"rgba("+s(this._r)+", "+s(this._g)+", "+s(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:s(100*B(this._r,255))+"%",g:s(100*B(this._g,255))+"%",b:s(100*B(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+s(100*B(this._r,255))+"%, "+s(100*B(this._g,255))+"%, "+s(100*B(this._b,255))+"%)":"rgba("+s(100*B(this._r,255))+"%, "+s(100*B(this._g,255))+"%, "+s(100*B(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(k[p(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+m(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=h(e);n="#"+m(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return h(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(x,arguments)},brighten:function(){return this._applyModification(S,arguments)},darken:function(){return this._applyModification(C,arguments)},desaturate:function(){return this._applyModification(v,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(b,arguments)},spin:function(){return this._applyModification(A,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(M,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(E,arguments)},triad:function(){return this._applyCombination(P,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},h.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]="a"===r?e[r]:T(e[r]));e=n}return h(e,t)},h.equals=function(e,t){return!(!e||!t)&&h(e).toRgbString()==h(t).toRgbString()},h.random=function(){return h.fromRatio({r:l(),g:l(),b:l()})},h.mix=function(e,t,n){n=0===n?0:n||50;var r=h(e).toRgb(),i=h(t).toRgb(),o=n/100;return h({r:(i.r-r.r)*o+r.r,g:(i.g-r.g)*o+r.g,b:(i.b-r.b)*o+r.b,a:(i.a-r.a)*o+r.a})},h.readability=function(e,t){var n=h(e),r=h(t);return(i.max(n.getLuminance(),r.getLuminance())+.05)/(i.min(n.getLuminance(),r.getLuminance())+.05)},h.isReadable=function(e,t,n){var r,i,o=h.readability(e,t);switch(i=!1,(r=function(e){var t,n;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),n=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==n&&"large"!==n&&(n="small");return{level:t,size:n}}(n)).level+r.size){case"AAsmall":case"AAAlarge":i=o>=4.5;break;case"AAlarge":i=o>=3;break;case"AAAsmall":i=o>=7}return i},h.mostReadable=function(e,t,n){var r,i,o,a,c=null,s=0;i=(n=n||{}).includeFallbackColors,o=n.level,a=n.size;for(var u=0;u<t.length;u++)(r=h.readability(e,t[u]))>s&&(s=r,c=h(t[u]));return h.isReadable(e,c,{level:o,size:a})||!i?c:(n.includeFallbackColors=!1,h.mostReadable(e,["#fff","#000"],n))};var O=h.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},k=h.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(O);function G(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function B(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=u(t,d(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function D(e){return u(1,d(0,e))}function L(e){return parseInt(e,16)}function N(e){return 1==e.length?"0"+e:""+e}function T(e){return e<=1&&(e=100*e+"%"),e}function F(e){return i.round(255*parseFloat(e)).toString(16)}function X(e){return L(e)/255}var Y,j,R,z=(j="[\\s|\\(]+("+(Y="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+Y+")[,|\\s]+("+Y+")\\s*\\)?",R="[\\s|\\(]+("+Y+")[,|\\s]+("+Y+")[,|\\s]+("+Y+")[,|\\s]+("+Y+")\\s*\\)?",{CSS_UNIT:new RegExp(Y),rgb:new RegExp("rgb"+j),rgba:new RegExp("rgba"+R),hsl:new RegExp("hsl"+j),hsla:new RegExp("hsla"+R),hsv:new RegExp("hsv"+j),hsva:new RegExp("hsva"+R),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function H(e){return!!z.CSS_UNIT.exec(e)}e.exports?e.exports=h:void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}(Math)},function(e,t,n){var r;
/*!
 * EventEmitter v5.2.6 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */!function(t){"use strict";function i(){}var o=i.prototype,a=t.EventEmitter;function c(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function s(e){return function(){return this[e].apply(this,arguments)}}o.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp)for(n in t={},r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n]);else t=r[e]||(r[e]=[]);return t},o.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},o.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&((t={})[e]=n),t||n},o.addListener=function(e,t){if(!function e(t){return"function"==typeof t||t instanceof RegExp||!(!t||"object"!=typeof t)&&e(t.listener)}(t))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===c(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},o.on=s("addListener"),o.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},o.once=s("addOnceListener"),o.defineEvent=function(e){return this.getListeners(e),this},o.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},o.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=c(i[r],t))&&i[r].splice(n,1);return this},o.off=s("removeListener"),o.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},o.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},o.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},o.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},o.removeAllListeners=s("removeEvent"),o.emitEvent=function(e,t){var n,r,i,o,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),i=0;i<n.length;i++)!0===(r=n[i]).once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},o.trigger=s("emitEvent"),o.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},o.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=a,i},void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)}("undefined"!=typeof window?window:this||{})},function(e,t,n){var r=n(1),i=n(5);r.registerCommand("common",{back:i})},function(e,t,n){var r=n(1),i=n(18),o=n(19),a=n(20);r.registerCommand("move",{enable:i,toMode:"move",execute:o,back:a})},function(e,t,n){n(1).registerCommand("add",{enable:function(){return this.type&&this.addModel},execute:function(e){var t=e.getCurrentPage(),n=t.getGraph().add(this.type,this.addModel);1===this.executeTimes&&(this.addId=n.id,this.page=t)},back:function(){this.page.getGraph().remove(this.addId)}})},function(e,t,n){var r=n(1),i=n(3);r.registerCommand("update",{enable:function(){return this.itemId&&this.updateModel},execute:function(e){var t=e.getCurrentPage(),n=t.getGraph(),r=n.find(this.itemId);1===this.executeTimes&&(this.originModel=i.getContrast(r.getModel(),this.updateModel),this.page=t),n.update(r,this.updateModel)},back:function(){var e=this.page.getGraph(),t=e.find(this.itemId);e.update(t,this.originModel)}})},function(e,t,n){var r=n(1),i=n(3),o=n(5);r.registerCommand("addGroup",{init:function(){this.addGroupId=i.guid()},enable:function(e){return e.getCurrentPage().getSelected().length>0},method:function(e){e.getCurrentPage().addGroup({id:this.addGroupId})},back:o})},function(e,t,n){var r=n(1),i=n(5);r.registerCommand("unGroup",{enable:function(e){var t=e.getCurrentPage().getSelected();return 1===t.length&&t[0].isGroup},method:"unGroup",back:i})},function(e,t,n){var r=n(1),i=n(10),o=n(11);r.registerCommand("zoomIn",{enable:function(e){var t=e.getCurrentPage(),n=t.getMaxZoom(),r=t.getMinZoom(),i=t.getZoom();return i<n||i===r},_zoom:function(e){var t=e.getCurrentPage(),n=t.getZoom(),r=t.getMaxZoom(),i=n+e.get("_command").zoomDelta;i>=r&&(i=r),t.zoom(i)},queue:!1,execute:i,back:o,shortcutCodes:[["metaKey","="],["ctrlKey","="]]})},function(e,t,n){var r=n(1),i=n(10),o=n(11);r.registerCommand("zoomOut",{enable:function(e){var t=e.getCurrentPage(),n=t.getMaxZoom(),r=t.getMinZoom(),i=t.getZoom();return i>r||i===n},_zoom:function(e){var t=e.getCurrentPage(),n=t.getZoom(),r=t.getMinZoom(),i=n-e.get("_command").zoomDelta;i<=r&&(i=r),t.zoom(i)},queue:!1,execute:i,back:o,shortcutCodes:[["metaKey","-"],["ctrlKey","-"]]})},function(e,t,n){var r=n(1),i=n(10),o=n(11);r.registerCommand("zoomTo",{_zoom:function(e){e.getCurrentPage().zoom(Number(this.zoom))},queue:!1,execute:i,back:o})},function(e,t,n){var r=n(1),i=n(10),o=n(11);r.registerCommand("autoZoom",{enable:function(){return!0},_zoom:function(e){e.getCurrentPage().autoZoom()},queue:!1,execute:i,back:o})},function(e,t,n){var r=n(1),i=n(10),o=n(11);r.registerCommand("resetZoom",{enable:function(){return!0},_zoom:function(e){e.getCurrentPage().resetZoom()},queue:!1,execute:i,back:o,shortcutCodes:[["metaKey","0"],["ctrlKey","0"]]})},function(e,t,n){var r=n(1),i=n(18),o=n(19),a=n(20);r.registerCommand("multiSelect",{enable:i,toMode:"multiSelect",execute:o,back:a})},function(e,t,n){var r=n(1),i=n(5);r.registerCommand("selectAll",{method:function(e){var t=e.getCurrentPage();t.getGraph().getItems().forEach(function(e){t.setSelected(e,!0)})},back:i,shortcutCodes:[["metaKey","a"]]})},function(e,t,n){var r=n(1),i=n(5),o=n(14);r.registerCommand("toBack",{enable:o,method:"toBack",back:i})},function(e,t,n){var r=n(1),i=n(5),o=n(14);r.registerCommand("toFront",{enable:o,method:"toFront",back:i})},function(e,t,n){var r=n(1),i=n(3),o=n(14);r.registerCommand("copy",{queue:!1,enable:o,method:function(e){var t=e.getCurrentPage().getSelected(),n=e.get("_command"),r=t.map(function(e){return e.getGraphicGroup()}),o=i.getChildrenBBox(r);n.clipboard=[],t.forEach(function(e){i.traverseTree(e,function(e){var t=e.getModel(),r=e.getGraphicGroup();n.clipboard.push({type:e.type,index:i.getIndex(r),model:t})},function(e){return e.getChildren&&e.getChildren()},!0)}),e.set("copyCenterBox",Object.assign({},o))}})},function(e,t,n){var r=n(1),i=n(3);r.registerCommand("copyAdjacent",{enable:function(){return this.copyNode&&this.copyNode.isNode&&this.x&&this.y},execute:function(e){var t=this.copyNode,n=e.getCurrentPage(),r=n.getGraph(),o=t.getModel(),a=i.clone(o);a.id=i.guid(),a.x=this.x,a.y=this.y;var c=r.add("node",a),s=r.add("edge",{source:o.id,target:a.id});1===this.executeTimes&&(this.addIds=[c.id,s.id],this.page=n)},back:function(){var e=this.page.getGraph();this.addIds.forEach(function(t){e.remove(t)})}})},function(e,t,n){var r=n(1),i=n(3),o=n(5),a=n(21);r.registerCommand("paste",{enable:function(e){return e.get("_command").clipboard.length>0},method:function(e){var t=e.getCurrentPage(),n=e.get("_command"),r=this.pasteData?this.pasteData:a(n.clipboard);t.clearSelected(),this.pasteData=i.clone(r),r.forEach(function(e){var n=e.model;n.x&&(n.x+=10),n.y&&(n.y+=10),t.add(e.type,n)})},back:o})},function(e,t,n){var r=n(1),i=n(3),o=n(5),a=n(21);r.registerCommand("pasteHere",{enable:function(e){return e.get("_command").clipboard.length>0},method:function(e){var t=e.getCurrentPage(),n=e.get("_command"),r=this.pasteData?this.pasteData:a(n.clipboard),o=this.copyCenterBox?this.copyCenterBox:e.get("copyCenterBox"),c=this.contextmenuPoint?this.contextmenuPoint:e.get("contextmenuPoint");t.clearSelected(),this.copyCenterBox=i.clone(o),this.pasteData=i.clone(r),this.contextmenuPoint=i.clone(c),r.forEach(function(e){var n=e.model;n.x&&(n.x+=c.x-o.minX),n.y&&(n.y+=c.y-o.minY),t.add(e.type,n)})},back:o})},function(e,t,n){n(1).registerCommand("collapseExpand",{getItem:function(e){var t=e.getCurrentPage(),n=t.getGraph();return this.itemId?n.find(this.itemId):t.getSelected()[0]},enable:function(e){var t=this.getItem(e);return t&&!1!==t.collapseExpand&&t.getChildren().length>0},execute:function(e){var t=e.getCurrentPage(),n=t.getGraph(),r=this.getItem(e);r.getModel().collapsed?(n.update(r,{collapsed:!1}),r.getInnerEdges&&r.getInnerEdges().forEach(function(e){e.update()}),this.toCollapsed=!1):(n.update(r,{collapsed:!0}),this.toCollapsed=!0),t.clearSelected(),t.setSelected(r,!0),1===this.executeTimes&&(this.itemId=r.id)},back:function(e){var t=e.getCurrentPage(),n=t.getGraph(),r=this.getItem(e);this.toCollapsed?n.update(r,{collapsed:!1}):n.update(r,{collapsed:!0}),t.clearSelected(),t.setSelected(r,!0)},shortcutCodes:[["metaKey","/"],["ctrlKey","/"]]})},function(e,t,n){n(1).registerCommand("collapse",{enable:function(e){var t=this.getItem(e);return t&&!1!==t.collapseExpand&&t.getChildren().length>0&&!t.getModel().collapsed}},"collapseExpand")},function(e,t,n){n(1).registerCommand("expand",{enable:function(e){var t=this.getItem(e);return t&&!1!==t.collapseExpand&&t.getChildren().length>0&&t.getModel().collapsed}},"collapseExpand")},function(e,t,n){n(1).registerCommand("redo",{queue:!1,enable:function(e){var t=e.get("_command"),n=t.queue;return t.current<n.length},execute:function(e){var t=e.get("_command");t.queue[t.current].execute(e),t.current+=1},shortcutCodes:[["metaKey","shiftKey","z"],["ctrlKey","shiftKey","z"]]})},function(e,t,n){n(1).registerCommand("undo",{queue:!1,enable:function(e){return e.get("_command").current>0},execute:function(e){var t=e.get("_command"),n=t.queue[t.current-1];n.executeTimes++,n.back(e),t.current-=1},shortcutCodes:[["metaKey","z"],["ctrlKey","z"]]})},function(e,t,n){var r=n(1),i=n(3),o=n(5);r.registerCommand("delete",{getDeleteItems:function(e){var t=e.getCurrentPage(),n=t.getGraph(),r=this.itemIds?this.itemIds.map(function(e){return n.find(e)}):t.getSelected();return r=r.filter(function(e){return!1!==e.deleteable})},enable:function(e){return this.getDeleteItems(e).length>0},method:function(e){var t=e.getCurrentPage(),n=this.getDeleteItems(e),r=t.getGraph();t.emit("beforedelete",{items:n}),i.each(n,function(e){r.remove(e)}),t.emit("afterdelete",{items:n}),this.itemIds=n.map(function(e){return e.getModel().id})},back:o,shortcutCodes:["Delete","Backspace"]})},function(e,t,n){var r=n(1),i=n(5);r.registerCommand("clear",{enable:function(e){return e.getCurrentPage().getItems().length>0},method:"clear",back:i})},function(e,t){function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}e.exports={INIT:"_initGraph",AUGMENT:{_initGraph:function(){var e=this.get("graph"),t=new(this.get("graphConstructor"))(n({page:this},e));t.draw(),this.set("_graph",t)},changeMode:function(e){this.get("_graph").changeMode(e)},updateMatrix:function(e){this.get("_graph").updateMatrix(e)},getMode:function(){return this.get("_graph").get("mode")},getMatrix:function(){return this.get("_graph").getMatrix()},getZoom:function(){return this.get("_graph").getMatrix()[0]},getMaxZoom:function(){return this.get("_graph").get("maxZoom")},getMinZoom:function(){return this.get("_graph").get("minZoom")},getGraph:function(){return this.get("_graph")},getItems:function(){return this.get("_graph").getItems()},getNodes:function(){return this.get("_graph").getNodes()},translate:function(e,t){return this.get("_graph").translate(e,t)},getEdges:function(){return this.get("_graph").getEdges()},getGroups:function(){return this.get("_graph").getGroups()},render:function(){return this.get("_graph").render(),this},add:function(e,t){return this.get("_graph").add(e,t),this},focusPointByDom:function(e){return this.get("_graph").focusPointByDom(e),this},focusPoint:function(e){return this.get("_graph").focusPoint(e),this},find:function(e){return this.get("_graph").find(e)},focus:function(e){var t=this.get("_graph"),n=t.find(e);return n&&t.focusPoint(n.getCenter()),this},save:function(){return this.get("_graph").save()},read:function(e){this.get("_graph").read(e)},clear:function(){this.get("_graph").clear()},remove:function(e){return this.get("_graph").remove(e)},update:function(e,t){return this.get("_graph").update(e,t)},zoom:function(e,t){return this.get("_graph").zoom(e,t)},getDomPoint:function(e){return this.get("_graph").getDomPoint(e)},getPoint:function(e){return this.get("_graph").getPoint(e)},zoomByDom:function(e,t){var n=this.get("_graph"),r=n.getPoint(e);return n.zoom(r,t),this},autoZoom:function(){return this.get("_graph").autoZoom(),this},resetZoom:function(){var e=this.get("_graph"),t=e.getWidth(),n=e.getHeight();return e.zoomByDom({x:t/2,y:n/2},1),this},css:function(e){},setCapture:function(e){this.get("_graph").getRootGroup().set("capture",e)},destroy:function(){this.get("_graph").destroy()},delete:function(){var e=this.getSelected(),t=this.get("_graph");e.forEach(function(e){t.remove(e)})}}}},function(e,t,n){var r=n(3);e.exports={CFG:{labelEditable:!0},INIT:"_initLabelEditor",AUGMENT:{_initLabelEditor:function(){var e=this;if(this.get("labelEditable")){var t=this.getGraph(),n=r.createDOM('<div contenteditable="true" role="textbox" tabindex="1" class="g6-label-editor"></div>',{position:"absolute",visibility:"hidden","z-index":"2",padding:"0px 2px 0px 0px",resize:"none",width:"auto",height:"auto",outline:"none",border:"1px solid #1890FF","transform-origin":"left top","max-width":"320px",background:"white","box-sizing":"content-box"});t.getGraphContainer().appendChild(n),n.on("blur",function(n){n.stopPropagation(),!t.destroyed&&e.endEditLabel()}),n.on("keydown",function(t){t.stopPropagation();var n=r.getKeyboradKey(t);(t.metaKey&&"s"===n||t.ctrlKey&&"s"===n)&&t.preventDefault(),"Enter"!==n&&"Escape"!==n||e.endEditLabel()}),this.set("labelTextArea",n),t.on("beforeviewportchange",function(){n.focusItem&&e.setLabelEditorBeginPosition(n.focusItem)})}},_getLabelTextAreaBox:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];t&&e.attr("text",t);var i=this.getGraph().getRootGroup(),o=r.getBBox(e,i);return{minX:o.minX-n[1],minY:o.minY-n[0],maxX:o.maxX+n[1],maxY:o.maxY+n[0]}},setLabelEditorBeginPosition:function(e){var t=this.get("labelTextArea"),n=e.getLabel();if(n){var i=this._getLabelTextAreaBox(n),o=n.attr("lineHeight"),a=n.attr("fontSize"),c={x:i.minX,y:i.minY-o/4+a/4-1,width:i.maxX-i.minX,height:i.maxY-i.minY};t.css({top:c.y+"px",left:c.x+"px"}),t.labelPoint=c}else{var s=this.getGraph().getRootGroup(),u=e.getKeyShape(),d=r.getBBox(u,s),l={x:d.minY+(d.maxY-d.minY-t.height())/2,y:(d.minX+d.maxX)/2};t.css({top:l.x+"px",left:l.y+"px"}),t.labelPoint=l}},beginEditLabel:function(e){var t=this.get("labelTextArea"),n=this.getGraph();if(r.isString(e)&&(e=n.find(e)),e&&!e.destroyed&&t){this.setSignal("preventWheelPan",!0);var i=e.getModel(),o=e.getLabel(),a=n.getZoom();if(t.focusItem=e,o){var c=o.attr("lineHeight"),s=this._getLabelTextAreaBox(o),u=(s.maxX-s.minX)/a,d=(s.maxY-s.minY+c/4)/a;t.innerHTML=i.label,t.innerHTML=i.label,t.css({"min-width":u+"px","min-height":d+"px",visibility:"visible","font-family":o.attr("fontFamily"),"line-height":c+"px","font-size":o.attr("fontSize")+"px",transform:"scale("+a+")"})}else t.innerHTML="",t.css({"min-width":"auto","min-height":"auto"});this.setLabelEditorBeginPosition(e),t.css({visibility:"visible"}),t.focus(),document.execCommand("selectAll",!1,null)}},endEditLabel:function(){var e=this.get("labelTextArea");if(this.setSignal("preventWheelPan",!1),e){var t=e.focusItem;if(t){var n=t.getModel(),r=this.editor;n.label!==e.textContent&&r.executeCommand("update",{action:"updateLabel",itemId:t.id,updateModel:{label:e.textContent}}),e.hide(),e.focusItem=void 0,this.focusGraphWrapper()}}}}}},function(e,t){function n(e,t,n){e.on(n,function(e){t.emit(n,e)}),e.on("node:"+n,function(e){t.emit("node:"+n,e)}),e.on("edge:"+n,function(e){t.emit("edge:"+n,e)}),e.on("group:"+n,function(e){t.emit("group:"+n,e)}),e.on("anchor:"+n,function(e){t.emit("anchor:"+n,e)})}e.exports={INIT:"_initEvent",AUGMENT:{_initEvent:function(){var e=this,t=this.get("_graph");n(t,this,"click"),n(t,this,"dblclick"),n(t,this,"mouseenter"),n(t,this,"mouseleave"),n(t,this,"mousedown"),n(t,this,"mouseup"),n(t,this,"contextmenu"),t.on("keydown",function(t){e.emit("keydown",t)}),t.on("keyup",function(t){e.emit("keyup",t)}),t.on("beforechange",function(t){e.emit("beforechange",t)}),t.on("afterchange",function(t){e.emit("afterchange",t)}),t.on("afterviewportchange",function(t){e.emit("afterviewportchange",t),t.updateMatrix[0]!==t.originMatrix[0]&&e.emit("afterzoom",t)}),t.on("beforeviewportchange",function(t){e.emit("beforeviewportchange",t),t.updateMatrix[0]!==t.originMatrix[0]&&e.emit("beforezoom",t)})}}}},function(e,t,n){var r=n(6);e.exports={CFG:{selectable:!0,multiSelectable:!0,_selectedCache:{}},INIT:"_initSelected",AUGMENT:{_initSelected:function(){var e=this,t=this.get("_graph");t.on("afteritemdraw",function(t){var n=t.item;n.isSelected&&e.setItemSelected(n)}),t.on("beforeitemdestroy",function(t){e.clearItemSelected(t.item)})},setItemSelected:function(e){var t=this.get("_graph").getShapeObj(e).getSelectedStyle(e),n=e.getKeyShape();this.get("_selectedCache")[e.id]=e,t&&n.attr(t),e.isEdge&&(e.startArrow&&e.startArrow.attr({fill:t.stroke}),e.endArrow&&e.endArrow.attr({fill:t.stroke}))},clearItemSelected:function(e){var t=this.get("_graph"),n=e.getKeyShape(),i=t.getShapeObj(e),o=i.getStyle(e),a=i.getSelectedStyle(e),c=this.get("_selectedCache"),s=r.getContrast(o,a);n.attr(s),e.isEdge&&(e.startArrow&&e.startArrow.attr({fill:s.stroke}),e.endArrow&&e.endArrow.attr({fill:s.stroke})),delete c[e.id]},setSelected:function(e,t){var n,i=this,o=this.get("selectable"),a=this.get("_graph");o&&(n=r.isArray(e)?e:[e],r.each(n,function(e){r.isString(e)&&(e=a.find(e)),e&&!e.destroyed&&(t?(i.emit("beforeitemselected",{item:e}),i.setItemSelected(e),i.emit("afteritemselected",{item:e})):(i.emit("beforeitemunselected",{item:e}),i.clearItemSelected(e),i.emit("afteritemunselected",{item:e})),e.isSelected=t,i.updateStatus(),a.draw())}))},getSelected:function(){var e=this.get("_selectedCache");return r.objectToValues(e)},clearSelected:function(){var e=this,t=this.get("_graph"),n=this.get("_selectedCache");r.each(n,function(t){t.isSelected&&e.setSelected(t,!1)}),t.draw()}}}},function(e,t){e.exports={AUGMENT:{updateStatus:function(){var e,t=this.getSelected();0===t.length?e="canvas-selected":1===t.length?t[0].isNode?e="node-selected":t[0].isEdge?e="edge-selected":t[0].isGroup&&(e="group-selected"):e="multi-selected",this.emit("statuschange",{status:e})}}}},function(e,t,n){var r=n(6);e.exports={CFG:{activeable:!0,_activedCache:{}},INIT:"_initActived",AUGMENT:{_initActived:function(){var e=this,t=this.get("_graph");t.on("afteritemdraw",function(t){var n=t.item;n.isActived&&e.setItemActived(n)}),t.on("beforeitemdestroy",function(t){e.clearItemActived(t.item)})},setItemActived:function(e){var t=this.get("_graph").getShapeObj(e),n=this.get("_activedCache"),r=t.getActivedStyle(e),i=e.getKeyShape();n[e.id]=e,r&&i.attr(r),e.isEdge&&(e.startArrow&&e.startArrow.attr({fill:r.stroke}),e.endArrow&&e.endArrow.attr({fill:r.stroke}))},clearItemActived:function(e){var t=this.get("_graph"),n=e.getKeyShape(),i=t.getShapeObj(e),o=i.getStyle(e),a=this.get("_activedCache"),c=i.getActivedStyle(e),s=r.getContrast(o,c);n.attr(s),e.isEdge&&(e.startArrow&&e.startArrow.attr({fill:s.stroke}),e.endArrow&&e.endArrow.attr({fill:s.stroke})),delete a[e.id]},setActived:function(e,t){var n,i=this,o=this.get("activeable"),a=this.get("_graph");o&&(n=r.isArray(e)?e:[e],r.each(n,function(e){r.isString(e)&&(e=a.find(e)),e&&!e.destroyed&&(t?(i.emit("beforeitemactived",{item:e}),i.setItemActived(e),i.emit("afteritemactived",{item:e})):(i.emit("beforeitemunactived",{item:e}),i.clearItemActived(e),i.emit("afteritemunactived",{item:e})),e.isActived=t)}),a.draw())},getActived:function(){var e=this.get("_activedCache");return r.objectToValues(e)},clearActived:function(){var e=this,t=this.get("_graph"),n=this.get("_activedCache");r.each(n,function(t){t.isActived&&e.setActived(t,!1)}),t.draw()}}}},function(e,t,n){var r=n(6),i=n(65);e.exports={CFG:{grid:null},INIT:"_initGrid",AUGMENT:{_initGrid:function(){var e=this.get("grid"),t=this.get("_graph");if(e){var n=new i(Object.assign({page:this,graph:t},e));this.setController("grid",n)}},showGrid:function(e){var t=this.get("_graph"),n=this.getController("grid");n||(e?r.isObject(e)&&this.set("grid",e):this.set("grid",!0),this._initGrid()),(n=this.getController("grid")).show(),t.draw()},hideGrid:function(){var e=this.get("_graph"),t=this.getController("grid");t&&t.hide(),e.draw()},getGridCell:function(){return this.getController("grid").getCell()}}}},function(e,t,n){var r=n(9),i=n(6),o=n(12),a=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.getDefaultCfg=function(){return{cell:16,line:o.gridStyle,type:"point",visible:!0}},a.init=function(){this._draw(),this._onViewPortChange(),!this.visible&&this.hide()},a._onViewPortChange=function(){var e=this,t=this.graph;t.on("afterviewportchange",function(){e.update()}),t.on("beforechangesize",function(){e.update()})},a._draw=function(){var e=this.graph,t=this._getPath(),n=e.getRootGroup(),r=i.mix({},this.line),o=e.getMatrix(),a=this.type,c="line"===a?1/o[0]:2/o[0];"point"===a&&(r.lineDash=null),r.lineWidth=c,r.path=t;var s=n.addShape("path",{attrs:r,capture:!1,zIndex:0});i.toBack(s,n),this.gridEl=s},a.show=function(){this.gridEl.show(),this.visible=!0},a.hide=function(){this.gridEl.hide(),this.visible=!1},a._getLinePath=function(){for(var e=this.graph,t=e.get("width"),n=e.get("height"),r=e.getPoint({x:0,y:0}),i=e.getPoint({x:t,y:n}),o=this.cell,a=Math.ceil(r.x/o)*o,c=Math.ceil(r.y/o)*o,s=[],u=0;u<=i.x-r.x;u+=o){var d=a+u;s.push(["M",d,r.y]),s.push(["L",d,i.y])}for(var l=0;l<=i.y-r.y;l+=o){var h=c+l;s.push(["M",r.x,h]),s.push(["L",i.x,h])}return s},a._getPointPath=function(){for(var e=this.graph,t=e.get("width"),n=e.get("height"),r=e.getPoint({x:0,y:0}),i=2/e.getMatrix()[0],o=e.getPoint({x:t,y:n}),a=this.getCell(),c=Math.ceil(r.x/a)*a,s=Math.ceil(r.y/a)*a,u=[],d=0;d<=o.x-r.x;d+=a)for(var l=c+d,h=0;h<=o.y-r.y;h+=a){var g=s+h;u.push(["M",l,g]),u.push(["L",l+i,g])}return path},a.getCell=function(){var e=this.cell,t=this.graph.getMatrix()[0];return e*t<9.6?9.6/t:e},a._getPath=function(){return this["_get"+i.upperFirst(this.type)+"Path"]()},a.update=function(e){i.mix(this,e);var t=this._getPath(),n=this.graph.getMatrix(),r="line"===this.type?1/n[0]:2/n[0];this.gridEl.attr("lineWidth",r),this.gridEl.attr("path",t)},a.destroy=function(){this.gridEl&&this.gridEl.remove()},r}(r);e.exports=a},function(e,t,n){var r=n(67);e.exports={CFG:{align:{}},INIT:"_initAlign",AUGMENT:{_initAlign:function(){var e=this.get("align"),t=this.get("_graph"),n=new r(Object.assign({flow:this,graph:t},e));this.setController("align",n)},align:function(e,t,n){return this.getController("align").align(e,t,n)},clearAlignLine:function(){return this.getController("align").clearAlignLine()}}}},function(e,t,n){var r=n(9),i=n(6),a=n(12),c=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var c=r.prototype;return c.getDefaultCfg=function(){return{line:a.alignLineStyle,item:!0,grid:!1,tolerance:5,_horizontalLines:{},_verticalLines:{},_alignLines:[]}},c.init=function(){this.item&&this._cacheBoxLine()},c._cacheBoxLine=function(){var e=this.graph,t=this._horizontalLines,n=this._verticalLines;e.on("afteritemdraw",function(e){var r=e.item;if(!i.isEdge(r)){var a=r.getBBox();!0===this.item||"horizontal"===this.item?(t[r.id+"tltr"]=[a.minX,a.minY,a.maxX,a.minY,r],t[r.id+"lcrc"]=[a.minX,a.centerY,a.maxX,a.centerY,r],t[r.id+"blbr"]=[a.minX,a.maxY,a.maxX,a.maxY,r]):"center"===this.item&&(t[r.id+"lcrc"]=[a.minX,a.centerY,a.maxX,a.centerY,r]),!0===this.item||"vertical"===this.item?(n[o.id+"tlbl"]=[a.minX,a.minY,a.minX,a.maxY,o],n[r.id+"tcbc"]=[a.centerX,a.minY,a.centerX,a.maxY,r],n[r.id+"trbr"]=[a.maxX,a.minY,a.maxX,a.maxY,r]):"center"===this.item&&(n[r.id+"tcbc"]=[a.centerX,a.minY,a.centerX,a.maxY,r])}}),e.on("beforeitemdestroy",function(e){var r=e.item;delete t[r.id+"tltr"],delete t[r.id+"lcrc"],delete t[r.id+"blbr"],delete n[r.id+"tlbl"],delete n[r.id+"tcbc"],delete n[r.id+"trbr"]})},c.align=function(e,t){var n=i.mix({},e),r=this.flow.getController("grid");return this.grid&&r&&r.visible&&this._gridAlign(e,t),this.item&&this._itemAlign(e,t,n),e},c._gridAlign=function(e,t){var n=this.flow,r=this.grid,i=n.getGridCell();if("cc"===r){var o=Math.round((e.x+t.width/2)/i)*i,a=Math.round((e.y+t.height/2)/i)*i;e.x=o-t.width/2,e.y=a-t.height/2}else e.x=Math.round(e.x/i)*i,e.y=Math.round(e.y/i)*i},c._itemAlign=function(e,t,n){var r=this._horizontalLines,o=this._verticalLines,a=this.tolerance,c={x:n.x+t.width/2,y:n.y},s={x:n.x+t.width/2,y:n.y+t.height/2},u={x:n.x+t.width/2,y:n.y+t.height},l={x:n.x,y:n.y+t.height/2},h={x:n.x+t.width,y:n.y+t.height/2},g=[],f=[],p=null;if(this.clearAlignLine(),i.each(r,function(e){e[4].isVisible()&&(g.push(d(e,c)),g.push(d(e,s)),g.push(d(e,u)))}),i.each(o,function(e){e[4].isVisible()&&(f.push(d(e,l)),f.push(d(e,s)),f.push(d(e,h)))}),g.sort(function(e,t){return e.dis-t.dis}),f.sort(function(e,t){return e.dis-t.dis}),0!==g.length&&g[0].dis<a){e.y=g[0].line[1]-g[0].point.y+n.y,p={type:"item",horizontals:[g[0]]};for(var m=1;m<3;m++)g[0].dis===g[m].dis&&p.horizontals.push(g[m])}if(0!==f.length&&f[0].dis<a){e.x=f[0].line[0]-f[0].point.x+n.x,p?p.verticals=[f[0]]:p={type:"item",verticals:[f[0]]};for(var v=1;v<3;v++)f[0].dis===f[v].dis&&p.verticals.push(f[v])}p&&(p.bbox=t,this._addAlignLine(p))},c.clearAlignLine=function(){var e=this._alignLines;i.each(e,function(e){e.remove()}),this._alignLines=[]},c._addAlignLine=function(e){var t=e.bbox,n=this.graph.getRootGroup(),r=this.line,o=this._alignLines;"item"===e.type&&(e.horizontals&&i.each(e.horizontals,function(e){var a,c,s=e.line,u=e.point,d=(s[0]+s[2])/2;u.x<d?(a=u.x-t.width/2,c=Math.max(s[0],s[2])):(a=u.x+t.width/2,c=Math.min(s[0],s[2]));var l=n.addShape("line",{attrs:i.mix({x1:a,y1:s[1],x2:c,y2:s[1]},r),capture:!1});o.push(l)}),e.verticals&&i.each(e.verticals,function(e){var a,c,s=e.line,u=e.point,d=(s[1]+s[3])/2;u.y<d?(a=u.y-t.height/2,c=Math.max(s[1],s[3])):(a=u.y+t.height/2,c=Math.min(s[1],s[3]));var l=n.addShape("line",{attrs:i.mix({x1:s[0],y1:a,x2:s[0],y2:c},r),capture:!1});o.push(l)}))},r}(r);e.exports=c},function(e,t,n){n(69),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86)},function(e,t,n){n(0).registerBehaviour("clickCanvasSelected",function(e){var t=e.getGraph();t.behaviourOn("click",function(t){t.shape||(e.clearSelected(),e.clearActived(),e.updateStatus())}),t.behaviourOn("contextmenu",function(t){t.shape||(e.clearSelected(),e.clearActived(),e.updateStatus())})})},function(e,t,n){n(0).registerBehaviour("clickCollapsedButton",function(e){var t=e.getGraph();t.behaviourOn("click",function(n){var r=n.item,i=n.shape;r&&i&&i.isCollapsedButton&&(e.editor?e.editor.executeCommand("collapseExpand",{itemId:r.id}):t.update(r,{collapsed:!0}))})})},function(e,t,n){n(0).registerBehaviour("clickEdgeSelected",function(e){e.getGraph().behaviourOn("edge:click",function(t){e.get("multiSelectable")&&!0===e.getSignal("shiftKeyDown")?e.setSelected(t.item.id,!0):(e.clearActived(),e.clearSelected(),e.setSelected(t.item.id,!0))})})},function(e,t,n){n(0).registerBehaviour("clickExpandedButton",function(e){var t=e.getGraph();t.behaviourOn("click",function(n){var r=n.item,i=n.shape;r&&i&&i.isExpandedButton&&(e.editor?e.editor.executeCommand("collapseExpand",{itemId:r.id}):t.update(r,{collapsed:!1}))})})},function(e,t,n){n(0).registerBehaviour("clickGroupSelected",function(e){e.getGraph().behaviourOn("group:click",function(t){e.get("multiSelectable")&&!0===e.getSignal("shiftKeyDown")?e.setSelected(t.item.id,!0):(e.clearActived(),e.clearSelected(),e.setSelected(t.item.id,!0))})})},function(e,t,n){n(0).registerBehaviour("clickNodeSelected",function(e){e.getGraph().behaviourOn("node:click",function(t){e.get("multiSelectable")&&!0===e.getSignal("shiftKeyDown")?e.setSelected(t.item,!0):(e.clearActived(),e.clearSelected(),e.setSelected(t.item,!0))})})},function(e,t,n){n(0).registerBehaviour("dblclickItemEditLabel",function(e){e.getGraph().behaviourOn("node:dblclick",function(t){t.shape&&!t.shape.isButton&&e.beginEditLabel(t.item)})})},function(e,t,n){n(0).registerBehaviour("endPanItem",function(e){var t=e.getGraph();t.behaviourOn("panitemend",function(){var n=e.get("panItemDelegation");n&&(n.remove(),t.draw()),e.setSignal("panningItem",!1),e.set("panItemDelegation",null),e.set("panItemStartPoint",null),e.set("panItemStartBox",null),e.set("panItems",null)}),t.behaviourOn("canvas:mouseleave",function(){e.get("panItems")&&(e.clearAlignLine(),t.emit("panitemend"))})})},function(e,t,n){n(0).registerBehaviour("hoverButton",function(e){e.getGraph().behaviourOn("mouseenter",function(t){var n=t.shape;e.getSignal("panningItem")||n&&n.isButton&&e.css({cursor:"pointer"})})})},function(e,t,n){n(0).registerBehaviour("hoverEdgeActived",function(e){var t=e.getGraph();t.behaviourOn("edge:mouseenter",function(t){var n=t.item;e.getSignal("panningItem")||n&&n.isSelected||e.getSignal("dragEdge")||e.setActived(n,!0)}),t.behaviourOn("edge:mouseleave",function(t){e.setActived(t.item,!1)})})},function(e,t,n){n(0).registerBehaviour("hoverGroupActived",function(e){var t=e.getGraph();t.behaviourOn("mouseenter",function(t){var n=t.item,r=t.shape;e.getSignal("panningItem")||n&&n.isSelected||e.getSignal("dragEdge")||r&&r.isGroupKeyShape&&(e.css({cursor:"move"}),e.setActived(n,!0))}),t.behaviourOn("group:mouseleave",function(t){var n=t.item;n.isActived&&!n.isSelected&&e.setActived(n,!1)})})},function(e,t,n){n(0).registerBehaviour("hoverNodeActived",function(e){var t,n=e.getGraph();n.behaviourOn("node:mouseenter",function(n){var r=n.item;!1!==r.getShapeObj().panAble&&e.css({cursor:"move"}),e.getSignal("panningItem")||e.getSignal("dragEdge")||r&&r.isSelected||(t=r,e.setActived(t,!0))}),n.behaviourOn("node:mouseleave",function(n){var r=n.toShape;t&&(r&&r.isAnchor&&r.getItem()===t||e.getSignal("dragEdge")||(t.isSelected||e.setActived(t,!1),t=null))})})},function(e,t,n){n(0).registerBehaviour("keydownCmdWheelZoom",function(e){var t=e.getGraph();t.behaviourOn("keydown",function(t){91===t.domEvent.keyCode&&e.setSignal("wheelZoom",!0)}),t.behaviourOn("keyup",function(t){91===t.domEvent.keyCode&&e.setSignal("wheelZoom",!1)})})},function(e,t,n){var r=n(0),i=n(6);r.registerBehaviour("panBlank",i.getPanCanvasBehaviour(!0))},function(e,t,n){var r=n(0),i=n(6);r.registerBehaviour("panCanvas",i.getPanCanvasBehaviour())},function(e,t,n){n(0).registerBehaviour("processPanItem",function(e){var t=e.getGraph();t.behaviourOn("mousemove",function(n){var r=e.get("panItemDelegation");if(r){var i=e.get("panItemStartPoint"),o=e.get("panItemStartBox"),a=n.x-i.x,c=n.y-i.y,s=e.align({x:o.minX+a,y:o.minY+c},{width:o.width,height:o.height});r.attr({x:s.x,y:s.y}),t.emit("itempanning",n),t.draw()}})})},function(e,t,n){n(0).registerBehaviour("startPanItem",function(e){var t=e.getGraph(),n=t.getRootGroup();t.behaviourOn("dragstart",function(r){if(2!==r.button&&r.item&&(r.item.isNode||r.item.isGroup)){var i,o=r.item;if((i=(i=o.isSelected?e.getSelected():[o]).filter(function(e){return e.isNode||e.isGroup}))[0]&&!1!==i[0].dragable){var a=e.getDelegation(i,n),c=a.getBBox();t.emit("beforepanitem",{items:i}),t.emit("beforeshowdelegation",{items:i}),e.setSignal("panningItem",!0),e.set("panItems",i),e.set("panItemDelegation",a),e.set("panItemStartBox",c),e.set("panItemStartPoint",{x:r.x,y:r.y}),t.draw()}}})})},function(e,t,n){var r=n(0),i=n(6),o=n(12);r.registerBehaviour("wheelChangeViewport",function(e){var t,n=e.getGraph();n.behaviourOn("wheel",function(e){e.domEvent.preventDefault()}),n.behaviourOn("wheel",i.throttle(function(r){if(!e.getSignal("preventWheelPan")){var a=r.domEvent,c=e.getSignal("wheelZoom");if(t||e.setCapture(!1),c){var s=a.wheelDelta;if(Math.abs(s)>10){var u=n.getMatrix()[0];s>0?n.zoom({x:r.x,y:r.y},1.05*u):n.zoom({x:r.x,y:r.y},u*(1/1.05))}}else{var d=[],l=n.getMatrix();i.mat3.translate(d,l,[a.wheelDeltaX*o.wheelPanRatio,a.wheelDeltaY*o.wheelPanRatio]),e.translateLimt(d)&&n.updateMatrix(d)}t&&(clearTimeout(t),t=setTimeout(function(){e.setCapture(!0),t=null},50))}},16))})},function(e,t,n){var r=n(23);e.exports={dragingEdgeEndPoint:function(e){var t=e.endPointType,n=e.edgeModel,r=e.graph,i=e.delegation,o=e.startPoint,a=e.ev,c=e.source,s=e.target,u=a.item,d="source"===t?[a,o]:[o,a];u&&("source"===t?s=u:c=u);var l=r.getShapeObj("edge",n).getPathByPoints({points:d,source:c,target:s});i.attr("path",l),r.draw()},panGroup:function(e,t,n,i){var o=e.getModel();r.traverseTree(e,function(r){if("node"===r.type){var o=r.getModel();i.update(r,{x:o.x+t,y:o.y+n})}e.getCrossEdges&&e.getCrossEdges().forEach(function(e){e.update()})},function(e){return"group"===e.type?e.getChildren():[]}),i.update(e,{x:o.x+t,y:o.y+n})},dropUpdateEdge:function(e){var t=e.ev,n=e.endPointType,r=e.model,i=e.diagram,o=t.item,a=t.shape,c=t.x,s=t.y,u=i.get("noEndEdge"),d=i.get("linkAnchor"),l=i.get("linkNode");if(i.getGraph().emit("beforedropedge"),a){if(d&&a.isAnchor&&a.hasHotspot){var h=a.getItem();return"target"===n?(r.target=h.id,r.targetAnchor=a.getIndex()):(r.source=h.id,r.sourceAnchor=a.getIndex()),!0}if(l&&o&&o.isNode)return"target"===n?r.target=o.id:r.source=o.id,!0}else if(u)return"target"===n?r.target={x:c,y:s}:r.source={x:c,y:s},!0;return!1}}},function(e,t){e.exports=function(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),o=Math.min(e.maxY,t.maxY);return n>i||r>o}},function(e,t){e.exports={pointPoint:function(e,t){var n=Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2);return Math.sqrt(n)}}},function(e,t,n){var r=n(2);e.exports={AUGMENT:{changeAddEdgeModel:function(e){this.set("addEdgeModel",e)},cancelAdd:function(){this.set("addType",void 0),this.set("addModel",void 0),this.changeMode("default")},beginAdd:function(e,t){this.set("addType",e),this.set("addModel",t),this.changeMode("add")},endAdd:function(){this.set("addType",void 0),this.set("addModel",void 0),this.changeMode("default")},delete:function(){var e=this.getSelected(),t=this.get("_graph");e.forEach(function(e){t.remove(e)})},toBack:function(){var e=this.getSelected(),t=this.get("_graph");e.sort(function(e,t){var n=e.getGraphicGroup(),i=t.getGraphicGroup();return r.getIndex(i)-r.getIndex(n)}),e.forEach(function(e){t.toBack(e)})},toFront:function(){var e=this.getSelected(),t=this.get("_graph");e.sort(function(e,t){var n=e.getGraphicGroup(),i=t.getGraphicGroup();return r.getIndex(n)-r.getIndex(i)}),e.forEach(function(e){t.toFront(e)})},addGroup:function(e){var t,n=this.get("_graph"),i=this.getSelected(),o=!0;if(0!==i.length)if(i.forEach(function(e){var n=e.getParent();n&&(t?t!==n&&(o=!1):t=n)}),o){e||(e={label:"新建分组"}),r.setId(e),n.add("group",e),n.toFront(e.id);var a=n.find(e.id);t&&(e.parent=t.getModel().id),i.forEach(function(t){n.update(t,{parent:e.id})});var c=a.getInnerEdges();a.deepEach(function(e){n.toFront(e)}),c.forEach(function(e){n.toFront(e)})}else console.warn("add group elements must have the same parent")},unGroup:function(){var e=this.get("_graph"),t=this.getSelected(),n=t[0];1===t.length&&r.isGroup(n)&&(n.getChildren().forEach(function(t){e.update(t,{parent:null}),t.collapsedParent||t.show(),t.isGroup&&t.deepEach(function(e){e.collapsedParent||e.show()})}),e.remove(n))},newGroup:function(e){this.addGroup(e)}}}},function(e,t,n){var r=n(2),i=n(92);e.exports={CFG:{anchor:{}},INIT:"_initAnchor",AUGMENT:{_initAnchor:function(){var e=this.get("anchor")||{},t=this.get("_graph");if(e){var n=new i(Object.assign({diagram:this,graph:t},e));this.setController("anchor",n)}},showAnchor:function(e,t,n){this.getController("anchor").showAnchor(e,t,n)},clearAnchor:function(e){this.getController("anchor").clearAnchor(e)},setHotspotActived:function(e,t){this.getController("anchor").setHotspotActived(e,t)},hoverShowAnchor:function(e){var t=this,n=e.getAnchorPoints(),i=[];n.forEach(function(n,o){var a={anchor:n,item:e};t.emit("hovernode:beforeshowanchor",a),r.cancel||i.push(o)}),this.showAnchor(e,i)},anchorHasBeenLinked:function(e,t){var n=e.getEdges(),i=[];return n.forEach(function(t){var n=t.getModel();n.source!==e.id||r.isNil(n.sourceAnchor)||i.push(n.sourceAnchor),n.target!==e.id||r.isNil(n.targetAnchor)||i.push(n.targetAnchor)}),r.isObject(t)?-1!==i.indexOf(t.index):-1!==i.indexOf(t)},dragEdgeBeforeShowAnchor:function(e,t,n){var i=this;this.getGraph().getNodes().forEach(function(o){var a,c=[],s=o.getAnchorPoints();if(e.isNode){var u=e.getAnchorPoints();s.forEach(function(s,d){a="target"===n?{source:e,sourceAnchor:u[t],target:o,targetAnchor:s,dragEndPointType:n}:{target:e,targetAnchor:u[t],source:o,sourceAnchor:s,dragEndPointType:n},i.emit("dragedge:beforeshowanchor",a),r.cancel||c.push(d)})}else s.forEach(function(e,t){c.push(t)});o===e&&o.isAnchorShow?c.forEach(function(e){var n=o.getAnchor(e);t!==e&&n&&n.showHotspot()}):i.showAnchor(o,c,!0)})}}}},function(e,t,n){var r=n(9),i=n(2),o=n(4),a=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.getDefaultCfg=function(){return{_anchorItemCache:{}}},a.init=function(){var e=this,t=this.graph;t.on("afteritemdraw",function(t){t.item.isAnchorShow&&e.showAnchor(t.item)}),t.on("beforeitemdestroy",function(t){e._clearAnchor(t.item)}),t.on("afteritemhide",function(t){t.item.isNode&&e._clearAnchor(t.item)})},a._updateAnchor=function(e){e.anchorShapes.forEach(function(e){e.updatePosition()}),this.graph.draw()},a._drawAnchor=function(e,t,n,r){var a=e.getAnchorPoints();this._clearAnchor(e),i.each(a,function(i,a){if(!n||-1!==n.indexOf(a)){var c,s=t.addShape("marker",{attrs:Object.assign({symbol:"circle"},o.anchorPointStyle,{x:i.x,y:i.y}),freezePoint:i,item:e,index:a,eventPreFix:"anchor",isItemChange:function(){},zIndex:o.zIndex.anchorPoint});s.toFront(),s.eventPreFix="anchor",s.showHotspot=function(){c=t.addShape("marker",{attrs:Object.assign({symbol:"circle"},o.anchorHotsoptStyle,{x:i.x,y:i.y}),freezePoint:i,capture:!1,zIndex:o.zIndex.anchorHotsopt}),e.anchorShapes.push(c),s.hasHotspot=!0,c.toFront(),s.toFront()},s.getIndex=function(){return a},s.getItem=function(){return e},s.getPoint=function(){return i},s.updatePosition=function(){var t=e.getAnchorPoints()[a];s.attr(t)},s.setActived=function(){s.attr(o.anchorPointHoverStyle)},s.clearActived=function(){s.attr(o.anchorPointStyle)},s.isAnchor=!0,s.setHotspotActived=function(e){c&&(e?c.attr(o.anchorHotsoptActivedStyle):c.attr(o.anchorHotsoptStyle))},r&&s.showHotspot(),e.anchorShapes.push(s),e.getAllAnchors=function(){return e.anchorShapes.filter(function(e){return e.isAnchor})},e.getAnchor=function(t){return e.anchorShapes.find(function(e){return e.get("index")===t})}}})},a._clearAnchor=function(e){e.anchorShapes&&e.anchorShapes.forEach(function(e){e.remove()}),e.anchorShapes=[]},a.setHotspotActived=function(e,t){var n=this.diagram.getGraph();e.setHotspotActived(t),n.draw()},a.showAnchor=function(e,t,n){if(e.isVisible()){var r=this._anchorItemCache,i=this.graph.getRootGroup();this._drawAnchor(e,i,t,n),e.isAnchorShow=!0,r[e.id]=e}},a.clearAnchor=function(e){var t=this,n=this.graph,r=n.get("itemCache"),o=this._anchorItemCache,a=e;a=i.isObject(e)?[e]:i.isString(e)?[r[e]]:o,i.each(a,function(e){t._clearAnchor(e),e.isAnchorShow=!1,delete o[e.id]}),n.draw()},r}(r);e.exports=a},function(e,t,n){var r=n(94);e.exports={CFG:{orbit:null},INIT:"_initOrbit",AUGMENT:{_initOrbit:function(){var e=this.get("orbit");if(e){var t=new r(Object.assign({diagram:this},e));this.setController("orbit",t)}},showOrbit:function(e){this.getController("orbit").show(e)},hideOrbit:function(){this.getController("orbit").hide()},layoutOrbit:function(e,t){this.getController("orbit").layout(e,t)}}}},function(e,t,n){var r=n(9),i=n(2),o=n(4),a=n(95),c=i.vec2,s=i.isString,u=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=r.prototype;return i.getDefaultCfg=function(){return{satellite:[],satelliteCache:[]}},i.init=function(){var e=this,t=this.satellite,n=this.diagram,r={diagram:n};n.getGraph().addBehaviour("orbit"),t.forEach(function(t){s(t)?e.satelliteCache.push(new a[t](r)):e.satelliteCache.push(new a(Object.assign({},r,t)))})},i.layout=function(e,t){var n=this.diagram,r=n.getGraph(),i=e.getBBox(),a=i.centerX,s=i.centerY,u=n.getZoom(),d=o.orbitGap/u,l=this.satelliteCache.filter(function(e){return e.isVisible()}),h=[t.x-a,t.y-s],g=c.length(h),f=i.width/2+d,p=c.scale([],h,f/g);l.forEach(function(e){var t=e.getDOM(),n=t.width()/2,i=r.getDomPoint({x:p[0]+a,y:p[1]+s});t.css({top:i.y-n+"px",left:i.x-n+"px"})})},i.show=function(e){this.satelliteCache.forEach(function(t){t.enable()&&(t.item=e,t.show())})},i.hide=function(){this.satelliteCache.forEach(function(e){e.hide()})},r}(r);e.exports=u},function(e,t,n){var r=n(24),i=n(96);r.forkAndLink=i,e.exports=r},function(e,t,n){var r=n(2),i=function(e){var t,i;function o(){return e.apply(this,arguments)||this}return i=e,(t=o).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,o.prototype.getDefaultCfg=function(){return{name:"forkAndLink",render:function(){return'<div style="\n          width: 11px;\n          height: 11px;\n          cursor: copy;\n          background-image: '+n(97)+'\n        "></div>'},bindEvent:function(e,t){var n=this,i=t.getGraph().getRootGroup();return e.setAttribute("draggable","true"),[r.addEventListener(e,"dragstart",function(){var r=n.item,o=Object.assign({},t.get("addEdgeModel"),{source:r.id}),a=r.getBBox(),c=t.getDelegation([{isEdge:!0}],i);t.setSignal("dragEdge",!0),t.beginAdd("edge",o),t.set("addEdgeConfig",{addModel:o,delegation:c,startPoint:{x:a.centerX,y:a.centerY},sourceItem:r}),e.hide()})]}}},o}(n(24));e.exports=i},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTFweCIgaGVpZ2h0PSIxMXB4IiB2aWV3Qm94PSIwIDAgMTEgMTEiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjIgKDY3MTQ1KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5Hcm91cCBDb3B5IDUzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iMC44NDk5OTk5NjQiPgogICAgICAgIDxnIGlkPSLmi5PmiZHlm77nvJbor5HlmagiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMDQuMDAwMDAwLCAtMTYxNC4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLUNvcHktNTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwNC4wMDAwMDAsIDE2MTQuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsIiBzdHJva2U9IiMxODkwRkYiIGZpbGw9IiNGRkZGRkYiIGN4PSI1LjUiIGN5PSI1LjUiIHI9IjUiPjwvY2lyY2xlPgogICAgICAgICAgICAgICAgPHBvbHlnb24gaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjMTg5MEZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNSA1IDUgMyA2IDMgNiA1IDggNSA4IDYgNiA2IDYgOCA1IDggNSA2IDMgNiAzIDUiPjwvcG9seWdvbj4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"},function(e,t,n){var r=n(2),i=n(4);function o(e){e.controlPointShapes&&(r.each(e.controlPointShapes,function(e){e.remove()}),e.controlPointShapes=[],e.isControlPointShow=!1)}e.exports={INIT:"_initResize",CFG:{nodeResizeable:!1,edgeResizeable:!0},AUGMENT:{_initResize:function(){var e=this,t=this.get("_graph"),n=this.get("nodeResizeable"),i=this.get("edgeResizeable");n&&t.on("afteritemdraw",function(t){"node"===t.item.type&&t.item.isVisible()&&e.drawControlPoints(t.item)}),i&&t.on("afteritemdraw",function(t){"edge"===t.item.type&&t.item.isVisible()&&e.drawControlPoints(t.item)}),t.on("afteritemhide",function(e){var t=e.item;t.isControlPointShow&&(t.controlPointShapes&&r.each(t.controlPointShapes,function(e){e.hide()}),t.isControlPointShow=!1)}),t.on("afteritemshow",function(e){var t=e.item;e.item.isControlPointShow||(t.controlPointShapes&&r.each(t.controlPointShapes,function(e){e.show()}),t.isControlPointShow=!0)}),t.on("beforeitemdestroy",function(e){e.item.isControlPointShow&&o(e.item)})},drawControlPoints:function(e){var t=this.get("_graph").getRootGroup(),n=this.get("nodeResizeable"),a=this.get("edgeResizeable");if("node"===e.type){if(n){var c=e.getBBox(),s=[{x:c.minX,y:c.minY},{x:c.maxX,y:c.minY},{x:c.minX,y:c.maxY},{x:c.maxX,y:c.maxY}];o(e);var u=t.addShape("rect",{attrs:r.mix({},i.nodeSelectedBoxStyle,{symbol:"square",x:c.minX,y:c.minY,width:c.maxX-c.minX,height:c.maxY-c.minY})});e.controlPointShapes.push(u),r.each(s,function(n){var o=t.addShape("marker",{attrs:r.mix({},i.nodeControlPointStyle,{symbol:"square",x:n.x,y:n.y}),freezePoint:{x:n.x,y:n.y},item:e});e.controlPointShapes.push(o)})}}else if("edge"===e.type&&a){var d=e.getKeyShape().attr("path"),l=d[0],h=l.length,g=d[d.length-1],f=g.length,p=[{x:l[h-2],y:l[h-1]},{x:g[f-2],y:g[f-1]}],m=e.getModel();o(e),r.each(p,function(n,o){var a=t.addShape("marker",{attrs:r.mix({},i.edgeControlPointStyle,{x:n.x,y:n.y}),freezePoint:{x:n.x,y:n.y},item:e});a.eventPreFix="edgeControlPoint",a.getSourcePoint=function(){return p[0]},a.getTargetPoint=function(){return p[p.length-1]},a.getItem=function(){return e},a.isSourceEndPoint=function(){return m.source&&0===o},a.isTargetEndPoint=function(){return m.target&&o===p.length-1},e.controlPointShapes&&e.controlPointShapes.push(a)})}e.isControlPointShow=!0}}}},function(e,t){e.exports={CFG:{linkNode:!0,linkAnchor:!0},INIT:"_initLink",AUGMENT:{_initLink:function(){var e=this,t=this.getGraph(),n=this.get("linkAnchor"),r=this.get("linkNode"),i=t.get("mode");n&&(this.on("beforeitemactived",function(t){var n=t.item;n.isNode&&e.hoverShowAnchor(n)}),this.on("beforeitemunactived",function(t){var n=t.item;(n.isNode||n.isGroup)&&e.clearAnchor(n)}),this.on("beforeitemselected",function(t){var n=t.item;n.isNode?e.hoverShowAnchor(n):n.isGroup&&e.hoverShowAnchor(n)}),this.on("beforeitemunselected",function(t){var n=t.item;(n.isNode||n.isGroup)&&e.clearAnchor(n)}),t.addBehaviour("dragAnchorAddEdge","add"),t.addBehaviour("hoverAnchorActived","default"),t.changeMode(i)),r&&(t.addBehaviour("hoverNodeAddOutter","add"),t.addBehaviour("hoverNodeAddOutter","default"),t.changeMode(i))}}}},function(e,t,n){var r=n(2);e.exports={AUGMENT:{addOutterShape:function(e,t){this.clearOutterShape(e);var n=t.lineWidth,i=e.getKeyShape(),o=e.getGraphicGroup(),a=i.attr(),c=i.get("type"),s=i.attr("lineWidth"),u=r.clone(a);delete u.fillStyle,delete u.strokeStyle,delete u.matrix;var d=o.addShape(c,{attrs:Object.assign({},u,{fill:null},t)});r.toBack(d,o);var l=d.getBBox(),h=l.maxX-l.minX,g=l.maxY-l.minY,f=(l.minX+l.maxX)/2,p=(l.minY+l.maxY)/2;d.transform([["t",-f,-p],["s",(n+h+s)/h,(n+g+s)/g],["t",f,p]]),d.isOutter=!0,e.outterShape=d},clearOutterShape:function(e){e.outterShape&&e.outterShape.remove()}}}},function(e,t,n){n(102),n(103),n(104),n(105),n(106),n(107),n(108)},function(e,t,n){var r=n(7),i=n(2),o=n(4);r.registerNode("diagram-base",{getSize:function(e){var t=e.getModel();return i.getNodeSize(t.size)},defaultFillPalette:0,defaultStrokePalette:3,activedFillPalette:0,activedStrokePalette:5,selectedFillPalette:2,selectedStrokePalette:5,getDefaulStyle:function(){return o.nodeStyle},getDefaulActivedStyle:function(){return o.nodeActivedStyle},getDefaulSelectedtyle:function(){return o.nodeSelectedStyle},getStyle:function(e){var t,n,r=e.getModel(),o=r.color;if(o){var a=i.Palettes.generate(o);t=a[this.defaultFillPalette],n=a[this.defaultStrokePalette]}return i.deepMix({},this.getDefaulStyle(),{fill:t,stroke:n},r.style)},getPath:function(e){var t=this.getSize(e),n=this.getStyle(e);return i.getRectPath(-t[0]/2,-t[1]/2,t[0],t[1],n.radius)},getActivedOutterStyle:function(){return o.nodeActivedOutterStyle},getActivedStyle:function(e){var t=e.getModel(),n=this.getDefaulActivedStyle(e),r=t.color;if(r){var o=i.Palettes.generate(r);return Object.assign({},n,{fill:o[this.activedFillPalette],stroke:o[this.activedStrokePalette]})}return n},getSelectedStyle:function(e){var t=e.getModel(),n=this.getDefaulSelectedtyle(e),r=t.color;if(r){var o=i.Palettes.generate(r);return Object.assign({},n,{fill:o[this.selectedFillPalette],stroke:o[this.selectedStrokePalette]})}return n},getSelectedOutterStyle:function(e){var t=e.getModel().color;if(t){var n=i.Palettes.generate(t);return Object.assign({},o.nodeSelectedOutterStyle,{stroke:n[1],fill:n[1]})}return o.nodeSelectedOutterStyle},anchor:[[.5,0],[1,.5],[.5,1],[0,.5]]})},function(e,t,n){var r=n(7),i=n(2);r.registerNode("capsule",{getPath:function(e){var t=this.getSize(e);return i.getRectPath(-t[0]/2,-t[1]/2,t[0],t[1],t[1]/2)}})},function(e,t,n){var r=n(7),i=n(2);r.registerNode("circle",{getPath:function(e){var t=this.getSize(e),n=t[0],r=t[1];return i.getEllipsePath(0,0,n/2,r/2)}})},function(e,t,n){var r=n(7),i=n(2);r.registerNode("rhombus",{getPath:function(e){var t=this.getSize(e),n=t[0],r=t[1],o=[{x:0,y:0-r/2},{x:0+n/2,y:0},{x:0,y:0+r/2},{x:0-n/2,y:0},{x:0,y:0-r/2}];return i.pointsToPolygon(o)}})},function(e,t,n){var r=n(7),i=n(2),o=n(4);r.registerEdge("diagram-base",{getPath:function(e){var t=e.getPoints(),n=e.getSource(),r=e.getTarget();return this.getPathByPoints({points:t,source:n,target:r,item:e})},getPathByPoints:function(e){return i.pointsToPolygon(e.points)},getStyle:function(e){var t=e.getModel();return i.deepMix({},o.edgeStyle,{stroke:t.color},t.style)},getActivedStyle:function(){return o.edgeActivedStyle},getSelectedStyle:function(){return o.edgeSelectedStyle},getActivedOutterStyle:function(){},getSelectedOutterStyle:function(){}})},function(e,t,n){var r=n(7),i=n(2);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function a(e,t){var n=Math.min(e.minX,t.minX),r=Math.min(e.minY,t.minY),i=Math.max(e.maxX,t.maxX),o=Math.max(e.maxY,t.maxY);return{centerX:(n+i)/2,centerY:(r+o)/2,minX:n,minY:r,maxX:i,maxY:o,height:o-r,width:i-n}}function c(e,t){return 2*Math.abs(e.centerX-t.centerX)<e.width+t.width&&2*Math.abs(e.centerY-t.centerY)<e.height+t.height}function s(e){var t=e.x,n=e.y;return{centerX:t,centerY:n,minX:t,minY:n,maxX:t,maxY:n,height:0,width:0}}function u(e,t){return 0===e.width&&0===e.height?e:{centerX:e.centerX,centerY:e.centerY,minX:e.minX-t,minY:e.minY-t,maxX:e.maxX+t,maxY:e.maxY+t,height:e.height+2*t,width:e.width+2*t}}function d(e,t){return function(e,t){var n=Math.abs(e.x-t.centerX),r=Math.abs(e.y-t.centerY);return n/t.width>r/t.height}(t,e)?{x:t.x>e.centerX?e.maxX:e.minX,y:t.y}:{x:t.x,y:t.y>e.centerY?e.maxY:e.minY}}function l(e){var t=e.minX,n=e.minY,r=e.maxX,i=e.maxY;return[{x:t,y:n},{x:r,y:n},{x:r,y:i},{x:t,y:i}]}function h(e,t){var n=e.x,r=e.y;return n<t.minX||n>t.maxX||r<t.minY||r>t.maxY}function g(e,t,n,r){var i=t.x-e.x,o=t.y-e.y,a=r.x-n.x,c=r.y-n.y,s=(-o*(e.x-n.x)+i*(e.y-n.y))/(-a*o+i*c),u=(a*(e.y-n.y)-c*(e.x-n.x))/(-a*o+i*c);return s>=0&&s<=1&&u>=0&&u<=1}function f(e,t,n){if(n.width===n.height===0)return!1;var r=o(l(n),4),i=r[0],a=r[1],c=r[2],s=r[3];return g(e,t,i,a)||g(e,t,i,s)||g(e,t,a,c)||g(e,t,c,s)}function p(e){return v(e)}function m(e,t){return[e,{x:e.x,y:t.y},t]}function v(e){var t=[],n={};return e.forEach(function(e){var t=e.id="".concat(e.x,"-").concat(e.y);n[t]=e}),i.each(n,function(e){t.push(e)}),t}function y(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function b(e,t,n,r,i){return y(e,t)+y(e,n)+function(e,t){var n=0;return t.forEach(function(t){t&&(e.x===t.x&&(n+=-2),e.y===t.y&&(n+=-2))}),n}(e,[t,n,r,i])}function x(e,t,n,r,i,o,a){var c=[],s=[t],u={},d={},l={};d[t.id]=0,l[t.id]=b(t,n,t);var h={};e.forEach(function(e){h[e.id]=e});for(var g=function(){var g,p,m,x=void 0,S=1/0;if(s.forEach(function(e){l[e.id]<S&&(S=l[e.id],x=e)}),x===n){var C=[];return function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;t.unshift(n[i]),r[i]&&r[i]!==i&&o<=100&&e(t,n,r,r[i],o+1)}(C,h,u,n.id),{v:C}}p=x,(m=(g=s).indexOf(p))>-1&&g.splice(m,1),c.push(x),function(e,t,n,r){var i=[];return e.forEach(function(e){e!==t&&(e.x!==t.x&&e.y!==t.y||f(e,t,n)||f(e,t,r)||i.push(e))}),v(i)}(e,x,r,i).forEach(function(e){if(-1===c.indexOf(e)){-1===s.indexOf(e)&&s.push(e);var r=l[x.id]+y(x,e);d[e.id]&&r>=d[e.id]||(u[e.id]=x.id,d[e.id]=r,l[e.id]=d[e.id]+b(e,n,t,o,a))}})};s.length;){var p=g();if("object"==typeof p)return p.v}return console.error("cannot find path: ",e,t,n),[t,n]}function S(e,t,n,r,i){var o=n&&n.bbox?n.bbox:s(e),g=r&&r.bbox?r.bbox:s(t);if(c(o,g))return p(m(e,t));var f=u(o,i),y=u(g,i);if(c(f,y))return p(m(e,t));var b=d(f,e),S=d(y,t),C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=[];e.forEach(function(e){t.push(e.x),n.push(e.y)});var r=Math.min.apply(Math,t),i=Math.max.apply(Math,t),o=Math.min.apply(Math,n),a=Math.max.apply(Math,n);return{centerX:(r+i)/2,centerY:(o+a)/2,maxX:i,maxY:a,minX:r,minY:o,height:a-o,width:i-r}}([b,S]),A=(a(f,y),a(f,C)),_=a(y,C),P=[];P=(P=P.concat(l(A))).concat(l(_));var w={x:(e.x+t.x)/2,y:(e.y+t.y)/2};[C,A,_].forEach(function(e){P=P.concat(function(e,t){return function(e,t){return t<e.minX||t>e.maxX?[]:[{x:t,y:e.minY},{x:t,y:e.maxY}]}(e,t.x).concat(function(e,t){return t<e.minY||t>e.maxY?[]:[{x:e.minX,y:t},{x:e.maxX,y:t}]}(e,t.y))}(e,w).filter(function(e){return h(e,f)&&h(e,y)}))}),[{x:b.x,y:S.y},{x:S.x,y:b.y}].forEach(function(e){h(e,f)&&h(e,y)&&P.push(e)}),P.unshift(b),P.push(S);var E=x(P=v(P),b,S,o,g,e,t);return E.unshift(e),E.push(t),p(E)}function C(e,t){var n=[],r=e[0];return n.push("M".concat(r.x," ").concat(r.y)),e.forEach(function(r,i){var a=e[i+1],c=e[i+2];if(a&&c)if(function(e,t,n){return!(e.x===t.x===n.x||e.y===t.y===n.y)}(r,a,c)){var s=o(function(e,t,n,r){var i=y(e,t),o=y(n,t);return i<r&&(r=i),o<r&&(r=o),[{x:t.x-r/i*(t.x-e.x),y:t.y-r/i*(t.y-e.y)},{x:t.x-r/o*(t.x-n.x),y:t.y-r/o*(t.y-n.y)}]}(r,a,c,t),2),u=s[0],d=s[1];n.push("L".concat(u.x," ").concat(u.y)),n.push("Q".concat(a.x," ").concat(a.y," ").concat(d.x," ").concat(d.y)),n.push("L".concat(d.x," ").concat(d.y))}else n.push("L".concat(a.x," ").concat(a.y));else a&&n.push("L".concat(a.x," ").concat(a.y))}),n.join("")}r.registerEdge("polyline",{getPathByPoints:function(e){var t=e.points,n=e.source,r=e.target,o=S(t[0],t[t.length-1],n,r,16);return i.pointsToPolygon(o)}}),r.registerEdge("polyline-round",{getPathByPoints:function(e){var t=e.points,n=e.source,r=e.target;return C(p(S(t[0],t[t.length-1],n,r,16)),5)}})},function(e,t,n){var r=n(7),i=n(2),o=n(4),a=i.getGroupIconPath(),c=i.getCollapsedButtonPath(),s=i.getExpandedButtonPath(),u={fill:"#CED4D9"},d={stroke:"#697B8C",fill:"#fff",fillOpacity:0},l={stroke:"#697B8C",fill:"#fff",fillOpacity:0},h={fill:"#000000",textBaseline:"top",textAlign:"left"},g={stroke:"#CED4D9",fill:"#F2F4F5",radius:4},f=o.groupBackgroundPadding,p=184-f[1]-f[3],m=40-f[0]-f[2];r.registerGroup("diagram-base",{draw:function(e){var t=e.getModel(),n=e.getGraphicGroup(),r=e.getChildrenBBox(),o=this.getStyle(e),g=t.collapsed,v=t.padding?t.padding:f;if(r.minX===1/0&&(r.minX=t.x,r.maxX=t.x+p,r.minY=t.y,r.maxY=t.y+m),g&&(r.minX=r.maxX-p,r.maxY=r.minY+m),r.maxX-r.minX<p){var y=p+r.minX-r.maxX;r.minX-=y/2,r.maxX+=y/2}var b=r.minX-v[3],x=r.minY-v[0],S=r.maxX-r.minX+v[3]+v[1],C=r.maxY-r.minY+v[0]+v[2],A=n.addShape("path",{attrs:Object.assign({},o,{path:i.getRectPath(b,x,S,C,o.radius)})});A.isGroupKeyShape=!0;var _=i.isNil(t.label)?"新建分组":t.label,P=i.deepMix({},h,{x:b+40,y:x+13});i.isString(_)?P.text=_:i.mix(P,_),n.addShape("text",{attrs:P});var w,E=i.isNil(t.icon)?a:t.icon,M=n.addShape("path",{attrs:Object.assign({path:E},u)}),I=M.getBBox();if(M.translate(b-I.minX+8,x-I.minY+12),g){var O=(w=n.addShape("path",{attrs:Object.assign({path:s},l)})).getBBox(),k=O.maxX-O.minX;w.isExpandedButton=!0,w.translate(b+S-O.minX-k-12,x-O.minY+12)}else{var G=(w=n.addShape("path",{attrs:Object.assign({path:c},d)})).getBBox(),B=G.maxX-G.minX;w.isCollapsedButton=!0,w.translate(b+S-G.minX-B-12,x-G.minY+12)}return w.isButton=!0,w.item=e,t.x=r.minX,t.y=r.minY,A},getStyle:function(e){var t=e.getModel();return i.deepMix({},g,{fill:t.color,stroke:t.color},t.style)},getActivedStyle:function(){return o.groupActivedStyle},getSelectedStyle:function(){return o.groupSelectedStyle},getSelectedOutterStyle:function(){return o.groupSelectedOutterStyle},getActivedOutterStyle:function(){},intersectBox:"rect"})},function(e,t,n){n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123)},function(e,t,n){var r=n(0),i=n(2);r.registerBehaviour("dragAnchorAddEdge",function(e){var t=e.getGraph(),n=t.getRootGroup();t.behaviourOn("anchor:dragstart",function(t){if(2!==t.button){var r=t.shape,o=r.get("freezePoint"),a=r.getItem(),c=i.clone(e.get("addModel")),s=r.getIndex();c.source=a.id,c.sourceAnchor=s;var u={x:o.x,y:o.y},d=e.getDelegation([{isEdge:!0}],n);e.setSignal("dragEdge",!0),e.dragEdgeBeforeShowAnchor(a,s,"target"),e.set("addEdgeConfig",{addModel:c,delegation:d,startPoint:u,sourceItem:a})}})},["processAddEdge","dragHoverAnchorHotspot","hoverAnchorActived"])},function(e,t,n){var r=n(0),i=n(2),o=n(4);r.registerBehaviour("dragEdgeControlPoint",function(e){var t,n,r,a,c,s,u,d,l,h,g=e.getGraph(),f=g.getRootGroup();function p(h){if(r){var f={};g.getNodes().forEach(function(t){e.clearAnchor(t)}),e.css({cursor:o.cursor.beforePanCanvas}),r.remove();var p=i.dropUpdateEdge({ev:h,endPointType:t?"target":"source",model:f,diagram:e});g.show(l);var m=l.id;p&&(e.editor?e.editor.executeCommand("update",{itemId:m,updateModel:f}):g.update(m,f)),e.setSignal("dragEdge",!1),t=null,n=null,r=null,a=null,c=null,s=null,u=null,d=null,l=null,f=null}}g.behaviourOn("edgeControlPoint:mousedown",function(i){if(2!==i.button){var o=i.shape;o.isTargetEndPoint?(l=o.getItem(),h=l.getModel(),t=o,a=o.getSourcePoint(),c=l.getSource(),u=h.sourceAnchor):o.isSourceEndPoint&&(l=o.getItem(),h=l.getModel(),n=o,a=o.getTargetPoint(),s=l.getTarget(),d=h.targetAnchor),l&&(r=e.getDelegation([l],f),c?e.dragEdgeBeforeShowAnchor(c,u,"target"):s&&e.dragEdgeBeforeShowAnchor(s,d,"source"),g.hide(l),e.setSignal("dragEdge",!0))}}),g.behaviourOn("mousemove",function(e){r&&i.dragingEdgeEndPoint({endPointType:c?"target":"source",edgeModel:h,graph:g,delegation:r,startPoint:a,ev:e,originSource:c,originTarget:s})}),g.behaviourOn("edgeControlPoint:mouseleave",function(r){t||n||r.toShape||e.css({cursor:o.cursor.beforePanCanvas})}),g.behaviourOn("mouseup",p),g.behaviourOn("canvas:mouseleave",p)},["dragHoverAnchorHotspot"])},function(e,t,n){n(0).registerBehaviour("dragHoverAnchorHotspot",function(e){var t=e.getGraph();t.behaviourOn("anchor:dragenter",function(t){e.getSignal("dragEdge")&&e.setHotspotActived(t.shape,!0)}),t.behaviourOn("anchor:dragleave",function(t){e.getSignal("dragEdge")&&e.setHotspotActived(t.shape,!1)})})},function(e,t,n){var r=n(0),i=n(4);r.registerBehaviour("dragMultiSelect",function(e){var t,n,r=e.getGraph(),o=r.getRootGroup();function a(){e.css({cursor:i.cursor.beforePanCanvas}),t=void 0,n=void 0}e.css({cursor:i.cursor.multiSelect}),r.behaviourOn("dragstart",function(e){2!==e.button&&(t={x:e.x,y:e.y},n=o.addShape("rect",{attrs:i.multiSelectRectStyle}))}),r.behaviourOn("drag",function(e){n&&(n.attr({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),width:Math.abs(e.x-t.x),height:Math.abs(e.y-t.y)}),r.draw())}),r.behaviourOn("dragend",function(){if(n){var t=r.getNodes().map(function(e){return e.id}),i=r.getGroups().map(function(e){return e.id}),o=n.getBBox(),c=e.editor;c?c.executeCommand(u):u(),n.remove(),e.changeMode("default"),e.updateStatus(),r.draw(),a()}function s(e){return e.filter(function(e){var t=r.find(e).getBBox();return t.minX>o.minX&&t.minY>o.minY&&t.maxX<o.maxX&&t.maxY<o.maxY})}function u(){e.clearSelected();var n=s(t),o=s(i);n.concat(o).forEach(function(t){var n=r.find(t);-1===o.indexOf(n.getModel().parent)&&e.setSelected(n,!0)})}}),r.behaviourOn("canvas:mouseleave",function(){n&&(n.remove(),r.draw(),a())})})},function(e,t,n){var r=n(0),i=n(4);r.registerBehaviour("dragNodeAddToGroup",function(e){var t,n,r=e.getGraph();function o(){e.setSignal("dragaddnodetogroup",!1),t=null,n=null}r.behaviourOn("dragenter",function(o){if(e.getSignal("panningItem")){var a=e.get("panItems");a[0]&&a[0].isNode&&1===a.length&&o.item&&o.item.isGroup&&a[0].getParent()!==o.item&&(t=a[0],n=o.item,r.update(n,{padding:i.groupBackgroundPadding.map(function(e){return e+4}),style:i.dragNodeHoverToGroupStyle}))}}),r.behaviourOn("dragleave",function(){n&&t&&r.update(n,{padding:null,style:null})}),r.behaviourOn("drop",function(i){var o,a;if(n&&t&&n===i.item){e.setSignal("dragaddnodetogroup",!0),o=t.id,a=n.id,r.update(a,{padding:null,style:null,collapsed:!1});var c=e.editor;c?c.executeCommand(s):s()}function s(){r.update(o,{parent:a})}}),r.behaviourOn("dragend",function(){o()}),r.behaviourOn("canvas:mouseleave",function(){n&&(r.update(n,{padding:null,style:null}),o())})})},function(e,t,n){var r=n(0),i=n(2),o=n(4);r.registerBehaviour("dragOutFromGroup",function(e){var t,n,r,a=e.getGraph(),c=!1;function s(){clearTimeout(r),n&&a.update(n,{padding:null,style:null}),c=!1,t=null,n=null}a.behaviourOn("drag",function(s){e.getSignal("panningItem")&&!c&&(clearTimeout(r),r=setTimeout(function(){var r=e.get("panItems");if(r){if(t=r[0],n=r[0].getParent(),t&&1===r.length&&n&&!s.shape){var u=e.get("panItemDelegation").getBBox(),d=n.getBBox();i.rectRectCrossAlgorithm(u,d)&&(a.update(n,{padding:o.groupBackgroundPadding.map(function(e){return e-8}),style:o.dragNodeLeaveFromGroupStyle}),c=!0)}c||(t=null,n=null)}},o.outFromGroupDelayTime))}),a.behaviourOn("dragenter",function(e){t&&n&&(n===e.item&&a.update(n,{padding:o.groupBackgroundPadding.map(function(e){return e+4}),style:o.dragNodeHoverToGroupStyle}),c=!1)}),a.on("drop",function(e){n&&t&&!e.shape&&(a.update(t,{parent:null}),a.update(n,{style:null}),s())}),a.on("dragend",function(){s()}),a.behaviourOn("canvas:mouseleave",function(){s()})})},function(e,t,n){var r=n(0),i=n(2);r.registerBehaviour("dragPanelItemAddNode",function(e){var t,n,r,o,a=e.getGraph(),c=a.getRootGroup();function s(){e.setSignal("panningItem",!1),e.set("panItemDelegation",null),e.set("panItemStartBox",null),e.set("panItemStartPoint",null),t=null,n=null,r=null,o=null}a.behaviourOn("canvas:mouseenter",function(a){var s=a.x,u=a.y;if(!t&&(r=e.get("addType"),o=i.clone(e.get("addModel")),"node"===r)){var d=(n=i.getNodeSize(o.size))[0]/2,l=n[1]/2,h={minX:s-d,minY:u-l,maxX:s+d,maxY:u+l,width:n[0],height:n[1]};t=e.getDelegation([h],c),e.setSignal("panningItem",!0),e.set("panItemDelegation",t),e.set("panItemStartBox",h),e.set("panItemStartPoint",{x:s,y:u})}}),a.behaviourOn("mouseup",function(n){var c=n.x,u=n.y,d=e.editor;t&&(o.x=c,o.y=u,i.setId(o),t.remove(),e.endAdd(),e.clearAlignLine(),e.clearSelected(),e.focusGraphWrapper(),d?d.executeCommand("add",{type:"node",addModel:o}):a.add(r,o),e.setSelected(a.find(o.id),!0),s())}),a.behaviourOn("canvas:mouseleave",function(){t&&(e.clearAlignLine(),t.remove(),a.draw(),e.cancelAdd(),s())})},["processPanItem"])},function(e,t,n){var r=n(0),i=n(4);r.registerBehaviour("hoverAnchorActived",function(e){var t=e.getGraph();t.behaviourOn("anchor:mouseenter",function(n){if(!e.getSignal("panningItem")&&!e.getSignal("dragEdge")){var r=n.shape,o=r.getItem(),a=o.getModel(),c=Object.assign({},e.get("addEdgeModel"),{source:a.id}),s={anchor:r.getPoint(),item:o};e.emit("hoveranchor:beforeaddedge",s),s.cancel?e.css({cursor:i.cursor.hoverUnEffectiveAnchor}):(e.css({cursor:i.cursor.hoverEffectiveAnchor}),!r.get("destroyed")&&r.setActived(),e.beginAdd("edge",c),t.draw())}}),t.behaviourOn("anchor:mouseleave",function(n){if(!e.getSignal("dragEdge")&&!e.getSignal("panningItem")){var r=n.shape,o=r.getItem();e.css({cursor:i.cursor.beforePanCanvas}),o.isSelected&&(e.clearAnchor(o),e.setActived(o,!1)),!r.get("destroyed")&&r.clearActived(),e.cancelAdd(),t.draw()}})})},function(e,t,n){var r=n(0),i=n(4);r.registerBehaviour("hoverEdgeControlPoint",function(e){e.getGraph().behaviourOn("edgeControlPoint:mouseenter",function(t){if(!e.getSignal("dragEdge")&&!e.getSignal("panningItem")){var n=t.shape;(n.isTargetEndPoint()||n.isSourceEndPoint())&&e.css({cursor:i.cursor.hoverEdgeControllPoint})}})})},function(e,t,n){n(0).registerBehaviour("hoverNodeAddOutter",function(e){var t,n=e.getGraph();n.behaviourOn("node:mouseenter",function(n){var r=n.item;e.getSignal("dragEdge")&&(t=r,e.addOutterShape(r,{stroke:"#52C41A",strokeOpacity:.45,lineWidth:4}))}),n.behaviourOn("node:mouseleave",function(){t&&e.clearOutterShape(t)}),n.behaviourOn("beforedropedge",function(){t&&e.clearOutterShape(t)})})},function(e,t,n){n(0).registerBehaviour("keydownShiftMultiSelected",function(e){var t=e.getGraph();t.behaviourOn("keydown",function(t){t.domEvent.shiftKey&&e.setSignal("shiftKeyDown",!0)}),t.behaviourOn("keyup",function(t){t.domEvent.shiftKey||e.setSignal("shiftKeyDown",!1)})})},function(e,t,n){var r=n(0),i=n(2),o=n(4);r.registerBehaviour("orbit",function(e){var t,n=e.getGraph();n.behaviourOn("beforepanitem",function(){e.hideOrbit()}),n.behaviourOn("node:mouseenter",function(n){var r=n.item;e.getSignal("panningItem")||e.getSignal("dragEdge")||(t=r,e.showOrbit(r))}),n.on("beforeviewportchange",function(){e.hideOrbit()}),n.behaviourOn("mousemove",function(r){var a=r.item,c=r.x,s=r.y;if(t){var u=t.getBBox(),d=i.euclideanDistance.pointPoint({x:u.centerX,y:u.centerY},{x:c,y:s});a!==t&&d>u.width/2+o.orbitGap/n.getMatrix()[0]&&(e.hideOrbit(),t=null),t&&e.layoutOrbit(t,{x:c,y:s})}})})},function(e,t,n){var r=n(0),i=n(2);r.registerBehaviour("panItem",function(e){var t=e.getGraph();t.behaviourOn("drop",function(){var n=e.get("panItems");if(n){var r=function(){o.forEach(function(e){var n=t.find(e),r=n.getModel();n.isGroup?i.panGroup(n,u,d,t):(t.update(n,{x:r.x+u,y:r.y+d}),t.toFront(n))}),1===o.length&&(e.clearSelected(),e.setSelected(a,!0))},o=n.map(function(e){return e.id}),a=n[0].id,c=e.get("panItemDelegation"),s=e.get("panItemStartBox"),u=c.attr("x")-s.minX,d=c.attr("y")-s.minY,l=e.editor;t.emit("afterpanitemdrop",{panItems:n}),e.clearAlignLine(),t.emit("panitemend"),!l||e.getSignal("dragaddnodetogroup")?r():l.executeCommand(r)}})},["startPanItem","processPanItem","endPanItem"])},function(e,t,n){var r=n(0),i=n(2),o=n(4);r.registerBehaviour("processAddEdge",function(e){var t=e.getGraph();function n(){e.setSignal("dragEdge",!1),e.set("addEdgeConfig",{addModel:null,delegation:null,startPoint:null,sourceItem:null})}t.behaviourOn("mousemove",function(n){var r=e.get("addEdgeConfig");if(r){var o=r.addModel,a=r.delegation,c=r.startPoint,s=r.sourceItem;a&&i.dragingEdgeEndPoint({endPointType:"target",edgeModel:o,graph:t,delegation:a,startPoint:c,ev:n,sourceItem:s})}}),t.behaviourOn("mouseup",function(r){var a=e.get("addEdgeConfig");if(a){var c=a.addModel,s=a.delegation,u=a.sourceItem,d=e.editor;if(s)t.getNodes().forEach(function(t){e.clearAnchor(t)}),e.clearAnchor(u),e.setActived(u,!1),e.setSelected(u,!1),e.css({cursor:o.cursor.beforePanCanvas}),s.remove(),i.dropUpdateEdge({ev:r,endPointType:"target",model:c,diagram:e})&&(d?d.executeCommand("add",{type:"edge",addModel:c}):t.add("edge",c)),t.draw(),e.endAdd(),n();else n()}}),t.behaviourOn("canvas:mouseleave",function(){var r=e.get("addEdgeConfig");if(r){var i=r.delegation,o=r.sourceItem;i&&(t.getNodes().forEach(function(t){e.clearAnchor(t)}),e.setActived(o,!1),e.clearAnchor(o),i.remove(),e.cancelAdd(),t.draw()),n()}})})},function(e,t,n){var r=n(13);n(125),e.exports=r},function(e,t,n){n(126),n(127),n(129)},function(e,t,n){n(13).registerNode("koni-base",{defaultFillPalette:5,defaultStrokePalette:5,activedFillPalette:4,activedStrokePalette:6,selectedFillPalette:5,selectedStrokePalette:6,anchor:null},"circle")},function(e,t,n){var r=n(13),i=n(128),o=i.vec2;r.registerEdge("koni-base",{getDefaultLabelRectPadding:function(){return i.toAllPadding([0,2])},getPathByPoints:function(e){var t=e.points,n=e.source,r=e.target,a=e.item;if(n&&r){var c=i.getParallelEdges(r,n),s=i.getParallelEdges(n,r),u=s.indexOf(a);if(n===r){u=(s=s.filter(function(e){var t=e.getModel();return t.source===n.id&&t.target===r.id})).indexOf(a);var d=n.getBBox(),l=d.centerX,h=d.centerY,g=d.width/2,f=50*(u+1)+50,p=[l-g/2,h-Math.sqrt(3)/2*g],m=[p[0]-l,p[1]-h],v=o.scale([],m,(g+f)/g),y=[l+v[0],h+v[1]],b=[l+g/2,h-Math.sqrt(3)/2*g],x=[b[0]-l,b[1]-h],S=o.scale([],x,(g+f)/g),C=[l+S[0],h+S[1]];return[["M",p[0],p[1]],["C",y[0],y[1],C[0],C[1],b[0],b[1]]]}0===c.length&&u--;var A=n.getBBox(),_=r.getBBox(),P=20*(u+1),w=[.5*(_.centerX+A.centerX)-A.centerX,.5*(_.centerY+A.centerY)-A.centerY],E=[-w[1],w[0]],M=o.length(E);o.scale(E,E,P/M);var I={x:w[0]+E[0]+A.centerX,y:w[1]+E[1]+A.centerY},O=n.getLinkPoints(I)[0],k=r.getLinkPoints(I)[0];return[["M",O.x,O.y],["Q",I.x,I.y,k.x,k.y]]}return i.pointsToPolygon(t)}})},function(e,t,n){var r=n(2);e.exports=r},function(e,t,n){n(13).registerGroup("koni-base",{})},function(e,t,n){var r=n(9),i=n(3),o=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.getDefaultCfg=function(){return{type:"toolbar",container:null}},o.init=function(){this._initContainer()},o._initContainer=function(){var e=this.container;if(!e)throw new Error("please set the container for the toolbar !");i.isString(e)&&(e=document.getElementById(e));var t=e.getElementsByClassName("command");this.commands=t},o.getCommandDoms=function(){return this.commands},r}(r);e.exports=o},function(e,t,n){var r=n(9),i=n(3),o=function(e){var t,n;function r(t){return e.call(this,t)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=r.prototype;return o.getDefaultCfg=function(){return{type:"contextmenu",container:null}},o.init=function(){this._initContainer()},o._initContainer=function(){var e=this.container;if(!e)throw new Error("please set the container for the contextmenu !");i.isString(e)&&(e=document.getElementById(e));var t=e.getElementsByClassName("command");e.style.position="absolute",e.style["z-index"]=2,e.style.top="0px",e.style.left="0px",this.commands=t,this.containerDom=e},o.bindEvent=function(){var e=this,t=this.commands;i.each(t,function(t){i.addEventListener(t,"click",function(){-1===t.className.indexOf("disable")&&e.hide()})})},o.switch=function(e){var t=this.containerDom.getElementsByClassName("menu");i.each(t,function(t){var n=t.dataset.status===e?"block":"none";t.style.display=n})},o.getCommandDoms=function(){return this.commands},o.show=function(){var e=this.containerDom;this.editor.getCurrentPage().setSignal("preventWheelPan",!0),e.style.display="block"},o.hide=function(){var e=this.containerDom;this.editor.getCurrentPage().setSignal("preventWheelPan",!1),e.style.display="none"},o.move=function(e,t){var n=this.containerDom,r=i.getBoundingClientRect(n),o=parseFloat(i.getStyle(n,"top")),a=parseFloat(i.getStyle(n,"left"));n.style.left=a+(e-r.left)+"px",n.style.top=o+(t-r.top)+"px"},r}(r);e.exports=o}])});
//# sourceMappingURL=index.js.map